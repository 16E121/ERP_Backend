"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[7208],{64568:(e,t,a)=>{a.d(t,{c:()=>r});var s=a(82496);const r=()=>(0,s.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},62344:(e,t,a)=>{a.d(t,{o$:()=>c,o5:()=>l,cF:()=>n,iI:()=>r});const s=a.p+"static/media/smt.aa4d4f940bbebff07a57.png",r={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},n={control:(e,t)=>({...e,height:"45px",background:"rgba(255, 255, 255, 0.322)"}),menu:(e,t)=>({...e,zIndex:9999})},c=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],l=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:s,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:s,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:s,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}]},45296:(e,t,a)=>{a.r(t),a.d(t,{default:()=>H});var s=a(69060),r=a(5548),n=a(82656),c=a(26773),l=a(4488),o=a(90048),d=a(28655),i=a(14168),m=a(86e3),u=a(45180),h=a(56480),p=a(77536),_=a(1908),j=(a(21680),a(64568)),x=a(39308),v=a(82496);const g=e=>{let{open:t,onClose:a,inputValue:r,isEdit:d,setReload:i}=e;const m=localStorage.getItem("user"),u=JSON.parse(m),[p,g]=(0,s.useState)([]),[y,b]=(0,s.useState)([]),[S,k]=(0,s.useState)({Project_Id:"",Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,x.Q7)(),Est_End_Dt:(0,x.Q7)(),Project_Status:"",Entry_By:null===u||void 0===u?void 0:u.UserId,Company_id:null===u||void 0===u?void 0:u.Company_id});(0,s.useEffect)((()=>{(0,_.q)({address:"masters/users/employee/dropDown?Company_id=".concat(null===u||void 0===u?void 0:u.Company_id)}).then((e=>{g(e.success?e.data:[])})).catch((e=>console.error("Fetch Error:",e)))}),[null===u||void 0===u?void 0:u.Company_id]),(0,s.useEffect)((()=>{(0,_.q)({address:"taskManagement/statusList"}).then((e=>{e.success&&b(e.data)})).catch((e=>console.error("Fetch Error:",e)))}),[]),(0,s.useEffect)((()=>{t&&(d&&r?k({...r,Est_Start_Dt:r.Est_Start_Dt?(0,x.Q7)(r.Est_Start_Dt):"",Est_End_Dt:r.Est_End_Dt?(0,x.Q7)(r.Est_End_Dt):""}):d||k({Project_Id:"",Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,x.Q7)(),Est_End_Dt:(0,x.Q7)(),Project_Status:"",Entry_By:null===u||void 0===u?void 0:u.UserId,Company_id:null===u||void 0===u?void 0:u.Company_id}))}),[r,t,d]);const f=e=>{k({...S,[e.target.name]:e.target.value})},T=()=>{const e=["Project_Name","Project_Head","Est_Start_Dt","Est_End_Dt","Project_Status","Project_Desc"];for(const t of e)if(!S[t])return h.m4.error("".concat(t.replace(/_/g," ")," is required")),!1;return!0},E=[{label:"Project Name",elem:"input",type:"text",required:!0,name:"Project_Name",value:S.Project_Name||""},{label:"Project Head",elem:"select",options:p.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))),required:!0,name:"Project_Head",value:S.Project_Head||""},{label:"Estimated Start Date",elem:"input",type:"date",required:!0,name:"Est_Start_Dt",value:S.Est_Start_Dt||""},{label:"Estimated End Date",elem:"input",type:"date",required:!0,name:"Est_End_Dt",value:S.Est_End_Dt||""},{label:"Project Status",elem:"select",options:y.map((e=>({value:e.Status_Id,label:e.Status}))),required:!0,name:"Project_Status",value:S.Project_Status||""},{label:"Description",elem:"textarea",name:"Project_Desc",value:S.Project_Desc||""}];return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(n.c,{open:t,onClose:a,children:[(0,v.jsx)(c.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:d?"Edit Project":"Create Project"}),(0,v.jsx)(l.c,{children:(0,v.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d?T()&&(0,_.q)({address:"taskManagement/project",method:"PUT",bodyData:S}).then((e=>{e.success?(a(),i((e=>!e)),h.m4.success(e.message)):h.m4.error(e.message)})).catch((e=>console.error("Fetch Error:",e))):(()=>{if(!T())return;const e={...S,Company_id:u.Company_id};(0,_.q)({address:"taskManagement/project",method:"POST",bodyData:e}).then((e=>{e.success?(a(),i((e=>!e)),h.m4.success(e.message)):h.m4.error(e.message)})).catch((e=>{console.error("Fetch Error:",e),h.m4.error("An error occurred while creating the project.")}))})()},children:[(0,v.jsx)("div",{className:"row",children:E.map(((e,t)=>(0,v.jsxs)("div",{className:"col-lg-4 mb-3",children:[(0,v.jsxs)("label",{children:[e.label," ",e.required&&(0,v.jsx)(j.c,{})]}),"textarea"===e.elem?(0,v.jsx)("textarea",{name:e.name,className:"cus-inpt",value:e.value,onChange:f}):"select"===e.elem?(0,v.jsxs)("select",{name:e.name,className:"cus-inpt",value:e.value,onChange:f,children:[(0,v.jsx)("option",{value:"",children:"Select"}),e.options&&e.options.map(((e,t)=>(0,v.jsx)("option",{value:e.value,children:e.label},t)))]}):(0,v.jsx)("input",{type:e.type,name:e.name,className:"cus-inpt",value:e.value,onChange:f})]},t)))}),(0,v.jsxs)(o.c,{children:[(0,v.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:a,children:"Cancel"}),(0,v.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:d?"Update":"Submit"})]})]})})]})})};var y=a(99904),b=a(33856),S=a(58612),k=a(27454),f=a(700),T=a(29504),E=a(71448),N=a(44380),C=a(89e3),D=a(12572),I=a(76552);const P=e=>{let{open:t,onClose:a,projectId:r,onReload:d}=e;const[i,m]=(0,s.useState)([]),[u,j]=(0,s.useState)(!0),[x,g]=(0,s.useState)(!1),[P,w]=(0,s.useState)([]),[A,O]=(0,s.useState)([]),M=localStorage.getItem("user"),F=JSON.parse(M),{contextObj:q}=(0,s.useContext)(p.a);(0,s.useEffect)((()=>{t&&r&&(R(),B(),L())}),[t,r]);const R=async()=>{j(!0);try{const e=await(0,_.q)({address:"masters/Employeedetails?Project_Id=".concat(r)});e.success&&m(e.data)}catch(e){console.error(e),h.m4.error("Failed to fetch employee details")}finally{j(!1)}},B=async()=>{j(!0);try{const e=await(0,_.q)({address:"masters/Employeedetails/dropDown?Company_id=".concat(F.Company_id)});e.success&&w(e.data)}catch(e){console.error(e),h.m4.error("Failed to fetch employees for dropdown")}finally{j(!1)}},L=async()=>{j(!0);try{const e=await(0,_.q)({address:"masters/Employeedetails?Project_Id=".concat(r)});e.success&&O(e.data)}catch(e){console.error(e),h.m4.error("Failed to fetch assigned employees")}finally{j(!1)}},H=()=>{g(!1)};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(n.c,{open:t,onClose:a,maxWidth:"sm",fullWidth:!0,children:[(0,v.jsxs)(D.c,{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:2,marginInlineStart:2,children:[(0,v.jsx)("span",{children:"Employee Details"}),(0,v.jsx)("button",{className:"btn btn-light",style:{marginRight:"18px "},onClick:a,children:"Close"})]}),(0,v.jsx)(l.c,{children:u?(0,v.jsx)("p",{children:"Loading..."}):(0,v.jsx)(y.c,{children:(0,v.jsxs)(b.c,{children:[(0,v.jsx)(S.c,{children:(0,v.jsxs)(k.c,{children:[(0,v.jsx)(f.c,{children:"Employee Name"}),(0,v.jsx)(f.c,{children:"Position"}),(0,v.jsx)(f.c,{children:"Department"})]})}),(0,v.jsx)(T.c,{children:i.map((e=>(0,v.jsxs)(k.c,{children:[(0,v.jsx)(f.c,{children:e.Name||"N/A"}),(0,v.jsx)(f.c,{children:e.Designation_Name||"-"}),(0,v.jsx)(f.c,{children:e.BranchName||"-"})]},e.EmployeeId||e.UserId)))})]})})}),(0,v.jsx)(o.c,{children:(0,v.jsx)("button",{className:"btn btn-primary",variant:"contained",color:"primary",onClick:()=>{g(!0)},sx:{mr:1},children:"Modify"})})]}),(0,v.jsxs)(n.c,{open:x,onClose:H,maxWidth:"sm",fullWidth:!0,children:[(0,v.jsx)(c.c,{children:"Add Employee"}),(0,v.jsx)(l.c,{children:(0,v.jsx)(E.c,{multiple:!0,options:P,getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,t)=>e.UserId===t.UserId,onChange:(e,t)=>{const a=t.filter(((e,t,a)=>t===a.findIndex((t=>t.UserId===e.UserId))));O(a)},PopperComponent:e=>(0,v.jsx)(I.c,{...e,placement:"top"}),value:A,renderInput:e=>(0,v.jsx)(N.c,{...e,placeholder:"Employees"})})}),(0,v.jsxs)(o.c,{children:[(0,v.jsx)(C.c,{onClick:H,children:"Cancel"}),(0,v.jsx)(C.c,{onClick:async()=>{if(1===Number(null===q||void 0===q?void 0:q.Add_Rights))try{(await(0,_.q)({address:"masters/Employeedetails/employeeAdd",method:"POST",bodyData:{Project_Id:r,UserIds:A.map((e=>e.UserId))}})).success?(h.m4.success("Employees added successfully"),g(!1),await R(),await L(),d()):h.m4.error("Failed to add employees")}catch(e){console.error(e),h.m4.error("Error adding employees")}},color:"primary",children:"Add"})]})]})]})};var w=a(32635),A=a(98420),O=a(98204),M=a(63744),F=a(30612),q=a(62344);const R=e=>{let{open:t,onClose:a,projectId:r,taskId:d,reload:i}=e;const m=localStorage.getItem("user"),u=JSON.parse(m),{contextObj:j}=(0,s.useContext)(p.a),[x,g]=(0,s.useState)([]),[y,b]=(0,s.useState)(!1),S={AN_No:"",Project_Id:r,Sch_Id:d,Assigned_Emp_Id:null===u||void 0===u?void 0:u.UserId,Emp_Id:"",Task_Assign_dt:(new Date).toISOString().split("T")[0],Sch_Period:"",Sch_Time:"",EN_Time:"",Est_Start_Dt:"",Est_End_Dt:"",Ord_By:1,Timer_Based:!0,Invovled_Stat:!0,EmpGet:"- Select Employee -"},[k,f]=(0,s.useState)(S);(0,s.useEffect)((()=>{(async()=>{try{b(!0);const e=await(0,_.q)({address:"masters/Employeedetails/getusersproject?Project_Id=".concat(r)});e.success?g(e.data||[]):h.m4.error("Failed to fetch employee dropdown.")}catch(e){console.error(e),h.m4.error("Error fetching employee dropdown.")}finally{b(!1)}})()}),[r,i]);return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(n.c,{open:t,onClose:a,maxWidth:"sm",children:[(0,v.jsx)(c.c,{children:"Assign Task"}),(0,v.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=(()=>{const[e,t]=k.Sch_Time.split(":").map(Number),[a,s]=k.EN_Time.split(":").map(Number),r=new Date(0,0,0,e,t),n=new Date(0,0,0,a,s);if(n>r){let e=Math.abs(n-r);const t=Math.floor(e/36e5);e%=36e5;const a=Math.floor(e/6e4);return"".concat(String(t).padStart(2,"0"),":").concat(String(a).padStart(2,"0"))}return""})();if(k.Est_End_Dt<k.Est_Start_Dt)h.m4.error("End date must be greater than start date.");else{f((e=>({...e,Sch_Period:t})));try{const e=await(0,_.q)({address:"masters/employeedetails/assignTask",method:"POST",bodyData:{Project_Id:r,Sch_Id:d.Sch_Id,Task_Levl_Id:1,Task_Id:Number(d.Task_Id),Assigned_Emp_Id:k.Assigned_Emp_Id,Emp_Id:k.Emp_Id,Sch_Period:t,Sch_Time:k.Sch_Time,EN_Time:k.EN_Time,Est_Start_Dt:k.Est_Start_Dt,Est_End_Dt:k.Est_End_Dt,Ord_By:k.Ord_By,Timer_Based:k.Timer_Based?1:0}});e.success?(h.m4.success("Task assigned successfully!"),f(S),i(),a()):h.m4.error("Failed to assign task: "+e.message)}catch(s){h.m4.error("Error during task assignment: "+s.message)}}},children:[(0,v.jsx)(l.c,{className:"table-responsive",children:(0,v.jsx)("table",{className:"table",children:(0,v.jsxs)("tbody",{children:[(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:"Employee"}),(0,v.jsx)("td",{className:"border-bottom-0 fa-15",children:(0,v.jsx)(F.cp,{value:{value:k.Emp_Id,label:k.EmpGet},onChange:e=>f({...k,Emp_Id:e.value,EmpGet:e.label}),options:[{value:"",label:"- Select Employee -"},...x.map((e=>({value:e.UserId,label:e.Name})))],styles:q.cF,required:!0,isSearchable:!0,placeholder:"Select User"})})]}),(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:"Start Time"}),(0,v.jsx)("td",{className:"border-bottom-0 fa-15",children:(0,v.jsx)("input",{type:"time",className:"cus-inpt",value:k.Sch_Time,required:!0,onChange:e=>f({...k,Sch_Time:e.target.value})})})]}),(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:"End Time"}),(0,v.jsx)("td",{className:"border-bottom-0 fa-15",children:(0,v.jsx)("input",{type:"time",className:"cus-inpt",value:k.EN_Time,required:!0,min:k.Sch_Time,onChange:e=>f({...k,EN_Time:e.target.value})})})]}),(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:"Start Date"}),(0,v.jsx)("td",{className:"border-bottom-0 fa-15",children:(0,v.jsx)("input",{type:"date",className:"cus-inpt",required:!0,value:k.Est_Start_Dt,onChange:e=>f({...k,Est_Start_Dt:e.target.value})})})]}),(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:"End Date"}),(0,v.jsx)("td",{className:"border-bottom-0 fa-15",children:(0,v.jsx)("input",{type:"date",className:"cus-inpt",required:!0,min:k.Est_Start_Dt,value:k.Est_End_Dt,onChange:e=>f({...k,Est_End_Dt:e.target.value})})})]}),(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:"Order By"}),(0,v.jsx)("td",{className:"border-bottom-0 fa-15",children:(0,v.jsx)("input",{type:"number",required:!0,placeholder:"1, 2, 3...",className:"cus-inpt",value:k.Ord_By,onChange:e=>f({...k,Ord_By:e.target.value})})})]}),(0,v.jsx)("tr",{children:(0,v.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle"},children:(0,v.jsxs)("div",{children:[(0,v.jsx)("input",{className:"form-check-input shadow-none",style:{padding:"0.7em"},type:"checkbox",id:"timerbased",checked:Boolean(k.Timer_Based),onChange:e=>f({...k,Timer_Based:e.target.checked})}),(0,v.jsx)("label",{className:"form-check-label p-1 ps-2",htmlFor:"timerbased",children:"Timer Based Task?"})]})})})]})})}),(0,v.jsxs)(o.c,{children:[(0,v.jsx)("button",{className:"btn btn-light",type:"button",onClick:a,children:"Close"}),(0,v.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Submit"})]})]})]})})};const B=function(e){let{dialogOpen:t,setDialogOpen:a,projectid:d,reload:i,onReload:m}=e;const[u,p]=(0,s.useState)(!1),[j,x]=(0,s.useState)(!1),[g,E]=(0,s.useState)(!1),[N,D]=(0,s.useState)(null),[I,P]=(0,s.useState)([]),[w,F]=(0,s.useState)({Task_Id:"",Task_Levl_Id:1,Type_Task_Id:"",Task_Sch_Duaration:"",Task_Group_Id:"",Task_Start_Time:(new Date).toISOString(),Task_End_Time:(new Date).toISOString(),Task_Est_Start_Date:(new Date).toISOString(),Task_Est_End_Date:(new Date).toISOString()}),[q,B]=(0,s.useState)([]),L=JSON.parse(localStorage.getItem("user")),H=null===L||void 0===L?void 0:L.UserId,U=null===L||void 0===L?void 0:L.Company_id,V=async()=>{try{const e=await(0,_.q)({address:"taskManagement/tasks/dropdown?Company_id=".concat(U)});e.success?P(e.data):h.m4.error(e.message)}catch(e){console.error(e)}};(0,s.useEffect)((()=>{V()}),[i,m]);const z=I.map((e=>({value:e.Task_Id,label:e.Task_Name}))),G=async()=>{try{const e=await(0,_.q)({address:"taskManagement/project/schedule/ListingDetails?Project_Id=".concat(d)});e.success?B(e.data):console.error("Failed to fetch task details:",e.message)}catch(e){console.error("Error fetching task details:",e)}};return(0,s.useEffect)((()=>{G()}),[i,d]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(n.c,{open:t,onClose:()=>a(!1),fullWidth:!0,maxWidth:"lg",PaperProps:{style:{height:"75vh"}},children:[(0,v.jsx)(c.c,{children:(0,v.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,v.jsx)("span",{children:"Task List"}),(0,v.jsx)(C.c,{variant:"contained",color:"primary",onClick:()=>x(!0),children:"Assign Task"})]})}),(0,v.jsx)(l.c,{children:(0,v.jsx)(y.c,{style:{maxHeight:"80vh"},children:(0,v.jsxs)(b.c,{stickyHeader:!0,children:[(0,v.jsx)(S.c,{children:(0,v.jsxs)(k.c,{children:[(0,v.jsx)(f.c,{children:"Task Name"}),(0,v.jsx)(f.c,{children:"Task Type"}),(0,v.jsx)(f.c,{children:"Status"}),(0,v.jsx)(f.c,{children:"Estimated Start Date"}),(0,v.jsx)(f.c,{children:"Estimated End Date"}),(0,v.jsx)(f.c,{children:"Assign"})]})}),(0,v.jsx)(T.c,{children:q.length>0?q.map((e=>(0,v.jsxs)(k.c,{children:[(0,v.jsx)(f.c,{children:e.Task_Name||"N/A"}),(0,v.jsx)(f.c,{children:e.Task_Type||"-"}),(0,v.jsx)(f.c,{children:e.Status}),(0,v.jsx)(f.c,{children:new Date(e.Task_Est_Start_Date).toLocaleDateString()||"N/A"}),(0,v.jsx)(f.c,{children:new Date(e.Task_Est_End_Date).toLocaleDateString()||"N/A"}),(0,v.jsx)(f.c,{children:(0,v.jsx)(r.c,{onClick:()=>(async e=>{D(e),E(!0)})(e),children:(0,v.jsx)(O.c,{})})})]},e.Task_Id))):(0,v.jsx)(k.c,{children:(0,v.jsx)(f.c,{colSpan:6,className:"text-center",children:"No tasks found"})})})]})})}),(0,v.jsx)(o.c,{children:(0,v.jsx)(C.c,{onClick:()=>a(!1),children:"Close"})})]}),(0,v.jsxs)(n.c,{open:j,onClose:()=>x(!1),fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},children:[(0,v.jsx)(c.c,{children:"Assign Task"}),(0,v.jsx)(l.c,{children:(0,v.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,v.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,v.jsx)("label",{htmlFor:"task-select",style:{marginRight:"8px"},children:"Select Task"}),(0,v.jsxs)("select",{id:"task-select",value:w.Task_Id||"",className:"cus-inpt",required:!0,onChange:e=>(async e=>{F((t=>({...t,Task_Id:e.value,TasksGet:e.label})));try{const t=await(0,_.q)({address:"taskManagement/tasks/tasklistsid?Task_Id=".concat(e.value)});if(t.success){const e=t.data;F((t=>({...t,Task_Levl_Id:e.Task_Levl_Id,Task_Name:e.Task_Name,Task_Desc:e.Task_Desc,Task_Group_Id:e.Task_Group_Id,Task_Sch_Duaration:e.Task_Sch_Duaration||"",Task_Start_Time:e.Task_Start_Time||(new Date).toISOString(),Task_End_Time:e.Task_End_Time||(new Date).toISOString(),Task_Est_Start_Date:e.Task_Est_Start_Date||(new Date).toISOString(),Task_Est_End_Date:e.Task_Est_End_Date||(new Date).toISOString()})))}else h.m4.error("Failed to fetch task details")}catch(t){h.m4.error(t)}})({value:e.target.value}),style:{flex:1,marginRight:"8px"},children:[(0,v.jsx)("option",{value:"",disabled:!0,children:"- select -"}),z.map(((e,t)=>(0,v.jsx)("option",{value:e.value,children:e.label},t)))]}),(0,v.jsx)(r.c,{onClick:()=>p(!0),children:(0,v.jsx)(A.c,{})})]})})}),(0,v.jsxs)(o.c,{children:[(0,v.jsx)("button",{className:"btn btn-light",variant:"outlined",onClick:()=>x(!1),children:"Cancel"}),(0,v.jsx)("button",{className:"btn btn-primary",variant:"contained",color:"primary",onClick:async()=>{if(!w.Task_Id)return void h.m4.error("Please select a task before saving.");const e={entryBy:H,Project_Id:d,Sch_Type_Id:1,Sch_Est_Start_Date:w.Task_Est_Start_Date,Sch_Est_End_Date:w.Task_Est_End_Date,tasks:[w]};try{(await(0,_.q)({address:"taskManagement/project/schedule/createNewTaskWithSchedule",method:"POST",bodyData:e})).success?(h.m4.success("Schedule Created Successfully"),x(!1),G(),m()):h.m4.error("Failed to Create Schedule")}catch(t){h.m4.error(t)}},children:"Save"})]})]}),(0,v.jsx)(R,{open:g,onClose:()=>E(!1),task:N,projectId:d,entryBy:H,taskId:N,reload:m}),(0,v.jsx)(M.c,{openAction:u,onCloseFun:()=>p(!1),onTaskAdded:V,Reload:i})]})};var L=a(4544);const H=()=>{const[e,t]=(0,s.useState)(!1),a=localStorage.getItem("user"),j=JSON.parse(a),[x,y]=(0,s.useState)([]),[b,S]=(0,s.useState)([]),{contextObj:k}=(0,s.useContext)(p.a),[f,T]=(0,s.useState)(!1),[E,N]=(0,s.useState)(null),[C,D]=(0,s.useState)(!1),[I,A]=(0,s.useState)(0),[O,M]=(0,s.useState)(!1),[F,q]=(0,s.useState)(null),[R,H]=(0,s.useState)(!1),[U,V]=(0,s.useState)(!1),[z,G]=(0,s.useState)("");(0,s.useEffect)((()=>{Q(),J()}),[null===j||void 0===j?void 0:j.Company_id,e]);const W=()=>{t((e=>!e))},Q=async()=>{try{const e=await(0,_.q)({address:"taskManagement/project/newProjectAbstract?Company_id=".concat(null===j||void 0===j?void 0:j.Company_id)});e.success&&Array.isArray(e.data)?y(e.data):(console.error("Unexpected data format:",e),y([]))}catch(e){console.error(e),y([])}},J=async()=>{try{const e=await(0,_.q)({address:"taskManagement/project?Company_id=".concat(null===j||void 0===j?void 0:j.Company_id)});e.success&&Array.isArray(e.data)?S(e.data):(console.error("Unexpected data format:",e),S([]))}catch(e){console.error(e),S([])}},Z=[{name:"Project Name",selector:e=>e.Project_Name,sortable:!0},{name:"Project Head",selector:e=>{var t;return null===(t=b.find((t=>t.Project_Id===e.Project_Id)))||void 0===t?void 0:t.Project_Head_Name},sortable:!0},{name:"Status",selector:e=>{var t;return null===(t=b.find((t=>t.Project_Id===e.Project_Id)))||void 0===t?void 0:t.Status},sortable:!0},{name:"Start Date",selector:e=>e.Est_Start_Dt?new Date(e.Est_Start_Dt).toLocaleDateString("en-IN"):"N/A",sortable:!0},{name:"End Date",selector:e=>e.Est_End_Dt?new Date(e.Est_End_Dt).toLocaleDateString("en-IN"):"N/A",sortable:!0},{name:"Progress",selector:e=>"".concat(ae(e.TasksScheduled,e.CompletedTasks),"%"),sortable:!0},{name:"Tasks / Completed",cell:e=>(0,v.jsxs)(v.Fragment,{children:[e.CompletedTasks," / ",e.TasksScheduled,(0,v.jsx)(r.c,{onClick:()=>X(e),style:{marginLeft:"8px"},children:(0,v.jsx)(d.c,{})})]})},{name:"Tasks Assigned",selector:e=>e.TasksAssignedToEmployee},{name:"Employees Involved",cell:e=>(0,v.jsxs)(v.Fragment,{children:[e.EmployeesInvolved,1===Number(null===k||void 0===k?void 0:k.Add_Rights)&&(0,v.jsx)(r.c,{onClick:()=>te(e.Project_Id),children:(0,v.jsx)(i.c,{})})]})},{name:"Actions",cell:e=>(0,v.jsxs)(v.Fragment,{children:[1===Number(null===k||void 0===k?void 0:k.Edit_Rights)&&(0,v.jsx)(r.c,{onClick:()=>Y(e),children:(0,v.jsx)(m.c,{})}),1===Number(null===k||void 0===k?void 0:k.Delete_Rights)&&(0,v.jsx)(r.c,{onClick:()=>$(e),children:(0,v.jsx)(u.c,{})})]})}],K=x.filter((e=>{var t,a;const s=(null===(t=b.find((t=>t.Project_Id===e.Project_Id)))||void 0===t?void 0:t.Project_Head_Name)||"",r=(null===(a=b.find((t=>t.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Status)||"";return e.Project_Name.toLowerCase().includes(z.toLowerCase())||s.toLowerCase().includes(z.toLowerCase())||r.toLowerCase().includes(z.toLowerCase())})),Y=e=>{console.log("Opening Edit Dialog for project:",e),N(e),D(!0),T(!0),console.log("Dialog Open State:",f)},$=e=>{q(e),M(!0)},X=e=>{N(e),A(e.Project_Id),V(!0)},ee=()=>{T(!1),V(!1),N(null),q(null),M(!1)},te=e=>{A(e),H(!0)},ae=(e,t)=>0===Number(e)?0:(Number(t)/Number(e)*100).toFixed(0);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"fw-bold d-flex align-items-center justify-content-between mt-0",children:[(0,v.jsx)("span",{children:"Projects"}),(0,v.jsxs)("div",{className:"mb-1",style:{display:"flex",alignItems:"center"},children:[(0,v.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[(0,v.jsx)(L.c,{style:{position:"absolute",left:15,color:"#aaa"}}),(0,v.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>G(e.target.value),style:{paddingLeft:35,marginRight:10,margin:10,borderRadius:4,border:"1px solid black"}})]}),1===Number(null===k||void 0===k?void 0:k.Add_Rights)&&(0,v.jsx)("button",{onClick:()=>(console.log("Opening Create Dialog"),N(null),D(!1),T(!0),void console.log("Dialog Open State:",f)),className:"btn btn-primary fa-13 shadow",children:"Create Project"})]})]}),(0,v.jsx)("div",{className:"card",children:(0,v.jsx)("div",{className:"card-body2 p-0",style:{marginTop:"0px",overflow:"hidden"},children:(0,v.jsx)(w.cp,{columns:Z,data:K,pagination:!0,highlightOnHover:!0,fixedHeader:!0,fixedHeaderScrollHeight:"58vh",persistTableHead:!0,noHeader:!1,customStyles:{headCells:{style:{fontSize:"16px",fontWeight:"bold",padding:"10px",backgroundColor:"#f7f7f7"}}}})})}),(0,v.jsx)(B,{onClose:ee,dialogOpen:U,setDialogOpen:V,isEdit:!1,parseData:j,projectid:I,onReload:W}),(0,v.jsx)(g,{open:f,onClose:ee,inputValue:E,isEdit:C,setReload:W,projectData:I}),(0,v.jsx)(P,{open:R,onClose:()=>H(!1),projectId:I,onReload:W}),(0,v.jsxs)(n.c,{open:O,onClose:ee,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,v.jsx)(c.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Confirmation"}),(0,v.jsxs)(l.c,{className:"p-4",children:["Do you want to delete the project",(0,v.jsx)("span",{className:"text-primary",children:" "+(null===F||void 0===F?void 0:F.Project_Name)+" "}),"?"]}),(0,v.jsxs)(o.c,{children:[(0,v.jsx)("button",{className:"btn btn-light rounded-5 px-3 me-1",onClick:ee,children:"Cancel"}),(0,v.jsx)("button",{className:"btn btn-primary rounded-5 px-3",onClick:()=>{F&&(0,_.q)({address:"taskManagement/project",method:"DELETE",bodyData:{Project_Id:null===F||void 0===F?void 0:F.Project_Id}}).then((a=>{a.success?(t(!e),h.m4.success(a.message)):h.m4.error(a.message)})).catch((e=>console.error("Fetch Error:",e))),M(!1)},children:"Delete"})]})]})]})}},63744:(e,t,a)=>{a.d(t,{c:()=>y});var s=a(69060),r=a(56480),n=(a(21680),a(67472),a(68424)),c=a(39504),l=a(82656),o=a(26773),d=a(4488),i=a(71448),m=a(52924),u=a(44380),h=a(90048),p=a(1908),_=a(39308),j=a(64568),x=a(82496);const v=(0,x.jsx)(n.c,{fontSize:"small"}),g=(0,x.jsx)(c.c,{fontSize:"small"}),y=e=>{var t;let{row:a,children:n,openAction:c,reload:y,onCloseFun:b,loadingOn:S,loadingOff:k,onTaskAdded:f,onToast:T}=e;const E=localStorage.getItem("user"),N=JSON.parse(E),C={Task_Id:"",Task_Name:"",Task_Desc:"",Task_Group_Id:0,Entry_By:null===N||void 0===N?void 0:N.UserId,Company_id:null===N||void 0===N?void 0:N.Company_id,Entry_Date:"",Update_By:"",Update_Date:"",Task_Parameters:[]},[D,I]=(0,s.useState)(!1),[P,w]=(0,s.useState)(!1),[A,O]=(0,s.useState)([]),[M,F]=(0,s.useState)([]),[q,R]=(0,s.useState)([]),[B,L]=(0,s.useState)(C);(0,s.useEffect)((()=>{(0,p.q)({address:"taskManagement/tasks/dropdown"}).then((e=>{e.success&&O(e.data)})).catch((e=>console.error(e))),(0,p.q)({address:"masters/taskType/dropDown"}).then((e=>{e.success&&F(e.data)})).catch((e=>console.error(e))),(0,p.q)({address:"taskManagement/parameters"}).then((e=>{e.success&&R(e.data)})).catch((e=>console.error(e)))}),[]),(0,s.useEffect)((()=>{I(!!c)}),[c]),(0,s.useEffect)((()=>{(0,_.CY)(a)?(L((e=>{let t={...e};return Object.entries(a).forEach((e=>{let[a,s]=e;t[a]=s})),t})),w(!0)):(L(C),w(!1))}),[a]);const H=()=>{L(C),I(!1),b&&b()};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{onClick:()=>I(!0),style:{cursor:"pointer"},children:n}),(0,x.jsxs)(l.c,{open:D,onClose:H,children:[(0,x.jsx)(o.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:P?"Edit Task":"Add Task"}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{var e;const t=(null===B||void 0===B||null===(e=B.Task_Parameters)||void 0===e?void 0:e.map((e=>({...e,Param_Id:null===e||void 0===e?void 0:e.Paramet_Id}))))||[],a={...B,Task_Parameters:t};S&&S();try{const e=await(0,p.q)({address:"taskManagement/tasks",method:P?"PUT":"POST",bodyData:a});e.success?(r.m4.success(e.message),H(),y&&y(),f()):r.m4.error(e.message)}catch(s){console.error(s),r.m4.error("An error occurred while processing your request.")}finally{k&&k()}})()},children:[(0,x.jsx)(d.c,{children:(0,x.jsxs)("div",{className:"row ",children:[(0,x.jsxs)("div",{className:"col-md-4 p-2",children:[(0,x.jsxs)("label",{children:["Task Name ",(0,x.jsx)(j.c,{})]}),(0,x.jsx)("input",{maxLength:150,onChange:e=>L({...B,Task_Name:e.target.value}),required:!0,value:null===B||void 0===B?void 0:B.Task_Name,placeholder:"ex: File Checking",className:"cus-inpt"})]}),(0,x.jsxs)("div",{className:"col-md-4 p-2",children:[(0,x.jsxs)("label",{children:["Task Group ",(0,x.jsx)(j.c,{})]}),(0,x.jsxs)("select",{value:B.Task_Group_Id,className:"cus-inpt",required:!0,onChange:e=>L({...B,Task_Group_Id:e.target.value}),children:[(0,x.jsx)("option",{value:0,disabled:!0,children:"- select -"}),null===M||void 0===M?void 0:M.map(((e,t)=>0!==Number(null===e||void 0===e?void 0:e.Task_Type_Id)&&(0,x.jsx)("option",{value:null===e||void 0===e?void 0:e.Task_Type_Id,children:null===e||void 0===e?void 0:e.Task_Type},t)))]})]}),(0,x.jsxs)("div",{className:"col-md-4 p-2",children:[(0,x.jsx)("label",{children:"Base Task"}),(0,x.jsxs)("select",{value:B.Under_Task_Id,className:"cus-inpt",onChange:e=>L({...B,Under_Task_Id:e.target.value}),children:[(0,x.jsx)("option",{value:0,children:"Primary"}),null===A||void 0===A?void 0:A.map(((e,t)=>(0,x.jsx)("option",{value:null===e||void 0===e?void 0:e.Task_Id,children:null===e||void 0===e?void 0:e.Task_Name},t)))]})]}),(0,x.jsxs)("div",{className:"col-12",children:[(0,x.jsxs)("label",{children:["Task Describtion ",(0,x.jsx)(j.c,{})]}),(0,x.jsx)("textarea",{className:"cus-inpt",value:B.Task_Desc,rows:"3",onChange:e=>L({...B,Task_Desc:e.target.value})})]}),(0,x.jsx)("div",{className:"col-md-12 p-2",children:(0,x.jsx)(i.c,{multiple:!0,id:"checkboxes-tags-demo",options:[...null===q||void 0===q?void 0:q.map((e=>({...e,Default_Value:""})))],disableCloseOnSelect:!0,getOptionLabel:e=>(null===e||void 0===e?void 0:e.Paramet_Name)+" - "+(null===e||void 0===e?void 0:e.Paramet_Data_Type),value:(null===B||void 0===B?void 0:B.Task_Parameters)||[],onChange:(e,t)=>L({...B,Task_Parameters:t}),renderOption:(e,t,a)=>{let{selected:s}=a;return(0,x.jsxs)("li",{...e,children:[(0,x.jsx)(m.c,{icon:v,checkedIcon:g,style:{marginRight:8},checked:s}),(null===t||void 0===t?void 0:t.Paramet_Name)+" - "+(null===t||void 0===t?void 0:t.Paramet_Data_Type)]})},className:"pt-2",isOptionEqualToValue:(e,t)=>Number(null===e||void 0===e?void 0:e.Paramet_Id)===Number(null===t||void 0===t?void 0:t.Paramet_Id),renderInput:e=>(0,x.jsx)(u.c,{...e,label:"Task Prarameters",placeholder:"Choose Task Parameters"})})}),null===B||void 0===B||null===(t=B.Task_Parameters)||void 0===t?void 0:t.map(((e,t)=>(0,x.jsxs)("div",{className:"col-md-4 p-2",children:[(0,x.jsx)("label",{className:"mb-2",children:null===e||void 0===e?void 0:e.Paramet_Name}),(0,x.jsx)("input",{type:(null===e||void 0===e?void 0:e.Paramet_Data_Type)||"text",className:"cus-inpt",onChange:e=>{const a=[...B.Task_Parameters];a[t]={...a[t],Default_Value:e.target.value},L({...B,Task_Parameters:a})},value:null===e||void 0===e?void 0:e.Default_Value,placeholder:"Default Value"})]},t)))]})}),(0,x.jsxs)(h.c,{children:[(0,x.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:H,children:"Cancel"}),(0,x.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Submit"})]})]})]})]})}},98420:(e,t,a)=>{var s=a(22411);t.c=void 0;var r=s(a(90864)),n=a(82496);t.c=(0,r.default)((0,n.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},98204:(e,t,a)=>{var s=a(22411);t.c=void 0;var r=s(a(90864)),n=a(82496);t.c=(0,r.default)((0,n.jsx)("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-1 9h-4v4h-2v-4H9V9h4V5h2v4h4z"}),"LibraryAdd")},4544:(e,t,a)=>{var s=a(22411);t.c=void 0;var r=s(a(90864)),n=a(82496);t.c=(0,r.default)((0,n.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},39504:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(27664),r=a(82496);const n=(0,s.c)((0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckBox")},68424:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(27664),r=a(82496);const n=(0,s.c)((0,r.jsx)("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"}),"CheckBoxOutlineBlank")},45180:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(27664),r=a(82496);const n=(0,s.c)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},86e3:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(27664),r=a(82496);const n=(0,s.c)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},28655:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(27664),r=a(82496);const n=(0,s.c)((0,r.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"Launch")},14168:(e,t,a)=>{a.d(t,{c:()=>n});var s=a(27664),r=a(82496);const n=(0,s.c)((0,r.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People")},90864:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.createSvgIcon}});var s=a(27492)},12572:(e,t,a)=>{a.d(t,{c:()=>d});var s=a(0),r=a(31152),n=a(46712),c=a(83068);const l=(0,a(10099).c)("MuiBox",["root"]),o=(0,n.c)(),d=(0,s.c)({themeId:c.c,defaultTheme:o,defaultClassName:l.root,generateClassName:r.c.generate})},90280:(e,t,a)=>{a.d(t,{c:()=>s});const s=a(91200).c},27492:(e,t,a)=>{a.r(t),a.d(t,{capitalize:()=>r.c,createChainedFunction:()=>n.c,createSvgIcon:()=>c.c,debounce:()=>l.c,deprecatedPropType:()=>o,isMuiElement:()=>d.c,ownerDocument:()=>i.c,ownerWindow:()=>m.c,requirePropFactory:()=>u,setRef:()=>h,unstable_ClassNameGenerator:()=>b,unstable_useEnhancedEffect:()=>p.c,unstable_useId:()=>_.c,unsupportedProp:()=>j,useControlled:()=>x.c,useEventCallback:()=>v.c,useForkRef:()=>g.c,useIsFocusVisible:()=>y.c});var s=a(31152),r=a(55832),n=a(90280),c=a(27664),l=a(72144);const o=function(e,t){return()=>null};var d=a(28276),i=a(93976),m=a(31328);a(45072);const u=function(e,t){return()=>null};const h=a(30472).c;var p=a(87188),_=a(18144);const j=function(e,t,a,s,r){return null};var x=a(61124),v=a(17908),g=a(56268),y=a(24724);const b={configure:e=>{s.c.configure(e)}}},0:(e,t,a)=>{a.d(t,{c:()=>h});var s=a(45072),r=a(95656),n=a(69060),c=a(79736),l=a(7592),o=a(6868),d=a(47100),i=a(47664),m=a(82496);const u=["className","component"];function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:a,defaultClassName:h="MuiBox-root",generateClassName:p}=e,_=(0,l.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(o.c);return n.forwardRef((function(e,n){const l=(0,i.c)(a),o=(0,d.c)(e),{className:j,component:x="div"}=o,v=(0,r.c)(o,u);return(0,m.jsx)(_,(0,s.c)({as:x,ref:n,className:(0,c.c)(j,p?p(h):h),theme:t&&l[t]||l},v))}))}}}]);
//# sourceMappingURL=7208.a4d5e66b.chunk.js.map