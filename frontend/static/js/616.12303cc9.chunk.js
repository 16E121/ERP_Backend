"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[616],{50616:(e,l,d)=>{d.r(l),d.d(l,{default:()=>D});var a=d(69060),s=d(3358),t=d(5548),i=d(43692),r=d(89e3),o=d(84436),n=d(82656),c=d(26773),u=d(4488),v=d(90048),m=(d(67472),d(30612)),h=d(62344),_=d(39308),x=d(91924),b=d(71412),j=d(86e3),I=d(61988),p=d(96064),g=d(80236),N=d(1908),S=d(13724),C=d(56480),y=d(45180),P=d(80156),T=d(36992),f=d(56084),G=d(64568),B=d(82496);const R=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 0:return(0,_.kR)(e*(l/100));case 1:return(0,_.kR)(e-e*(100/(100+l)));default:return 0}},A=function(){var e;let l=arguments.length>1?arguments[1]:void 0;return null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((e=>(0,_.Qr)(e.Product_Id,l))))&&void 0!==e?e:{}},Q=e=>{let{editValues:l,loadingOn:d,loadingOff:s,reload:i,switchScreen:o}=e;const x=JSON.parse(localStorage.getItem("user")),[b,I]=(0,a.useState)([]),[g,Q]=(0,a.useState)([]),[D,F]=(0,a.useState)([]),[w,O]=(0,a.useState)([]),[U,V]=(0,a.useState)({}),H={Company_Id:null===x||void 0===x?void 0:x.Company_id,So_Date:(0,_.Q7)(),Retailer_Id:"",Retailer_Name:"Select",Sales_Person_Id:null===x||void 0===x?void 0:x.UserId,Sales_Person_Name:null===x||void 0===x?void 0:x.Name,Branch_Id:null===x||void 0===x?void 0:x.BranchId,Narration:"",Created_by:null===x||void 0===x?void 0:x.UserId,Product_Array:[],So_Id:"",GST_Inclusive:1,IS_IGST:0},k={Item_Id:"",ItemName:"Search Item",Bill_Qty:0,Item_Rate:0,UOM:"",Units:"",Product:{},Group:"Search Group",GroupID:"",Brand:"Search Brand",BrandID:"",Amount:0},[M,L]=(0,a.useState)(H),[E,q]=(0,a.useState)([]),[X,z]=(0,a.useState)(k),[W,J]=(0,a.useState)(!1),[Y,K]=(0,a.useState)(!1),Z=(0,_.Qr)(M.GST_Inclusive,0),$=(0,_.Qr)(M.GST_Inclusive,1),ee=(0,_.Qr)(M.GST_Inclusive,2),le=(0,_.Qr)(M.IS_IGST,1);(0,a.useEffect)((()=>{var e;(0,_.CY)(l)?(L((e=>({...e,So_Date:null===l||void 0===l?void 0:l.So_Date,Retailer_Id:null===l||void 0===l?void 0:l.Retailer_Id,Retailer_Name:null===l||void 0===l?void 0:l.Retailer_Name,Sales_Person_Id:null===l||void 0===l?void 0:l.Sales_Person_Id,Sales_Person_Name:null===l||void 0===l?void 0:l.Sales_Person_Name,Branch_Id:null===l||void 0===l?void 0:l.Branch_Id,Narration:null===l||void 0===l?void 0:l.Narration,Created_by:null===l||void 0===l?void 0:l.Created_by,So_Id:null===l||void 0===l?void 0:l.So_Id,GST_Inclusive:null===l||void 0===l?void 0:l.GST_Inclusive,IS_IGST:null===l||void 0===l?void 0:l.IS_IGST}))),q(null===l||void 0===l||null===(e=l.Products_List)||void 0===e?void 0:e.map((e=>{var l,d,a,s,t,i,r,o,n,c,u,v,m,h,x,b,j;return{...e,Item_Id:null!==(l=e.Item_Id)&&void 0!==l?l:"",ItemName:null!==(d=null===e||void 0===e?void 0:e.Product_Name)&&void 0!==d?d:"",Bill_Qty:null!==(a=null===e||void 0===e?void 0:e.Bill_Qty)&&void 0!==a?a:0,Item_Rate:null!==(s=null===e||void 0===e?void 0:e.Item_Rate)&&void 0!==s?s:0,UOM:null!==(t=null===e||void 0===e?void 0:e.Unit_Id)&&void 0!==t?t:"",Units:null!==(i=null===e||void 0===e?void 0:e.Units)&&void 0!==i?i:"",Product:null!==(r={...e,Cgst_P:null!==(o=Number(null===(n=A(g,e.Item_Id))||void 0===n?void 0:n.Cgst_P))&&void 0!==o?o:0,Sgst_P:null!==(c=Number(null===(u=A(g,e.Item_Id))||void 0===u?void 0:u.Sgst_P))&&void 0!==c?c:0,Igst_P:null!==(v=Number(null===(m=A(g,e.Item_Id))||void 0===m?void 0:m.Igst_P))&&void 0!==v?v:0,Gst_P:null!==(h=(0,_.Q5)(null===(x=A(g,e.Item_Id))||void 0===x?void 0:x.Cgst_P,null===(b=A(g,e.Item_Id))||void 0===b?void 0:b.Sgst_P))&&void 0!==h?h:0})&&void 0!==r?r:{},Group:"Search Group",GroupID:"",Brand:"Search Brand",BrandID:"",Amount:null!==(j=null===e||void 0===e?void 0:e.Amount)&&void 0!==j?j:0}}))),J(!0)):(L(H),q([]),J(!1))}),[l,g]),(0,a.useEffect)((()=>{(0,N.q)({address:"masters/retailers/dropDown?Company_Id=".concat(null===x||void 0===x?void 0:x.Company_id)}).then((e=>{e.success&&I(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:"masters/uom"}).then((e=>{e.success&&O(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:"masters/products?Company_Id=".concat(null===x||void 0===x?void 0:x.Company_id)}).then((e=>{if(e.success){Q(e.data);const l=(0,_.Un)(e.data,"Brand",["Brand_Name"]);F(l)}else Q([]),F([])})).catch((e=>console.error(e))),(0,N.q)({address:"masters/company?Company_id=".concat(null===x||void 0===x?void 0:x.Company_id)}).then((e=>{e.success&&V(null!==e&&void 0!==e&&e.data[0]?null===e||void 0===e?void 0:e.data[0]:{})})).catch((e=>console.error(e)))}),[null===x||void 0===x?void 0:x.Company_id]);const de=()=>{K(!1),z(k)},ae=E.reduce(((e,l)=>{const d=(0,_.kR)(null===l||void 0===l?void 0:l.Item_Rate),a=parseInt(null===l||void 0===l?void 0:l.Bill_Qty),s=(0,_.eX)(a,d);if($||ee)return e+s;if(Z){const t=A(g,l.Item_Id),i=(0,_.Qr)(le,1)?t.Igst_P:t.Gst_P;return e+(s+R(0,d,i)*a)}}),0),se=E.reduce(((e,l)=>{const d=(0,_.kR)(null===l||void 0===l?void 0:l.Item_Rate),a=parseInt(null===l||void 0===l?void 0:l.Bill_Qty)||0;if(ee)return e.TotalValue+=(0,_.eX)(a,d),e;const s=A(g,l.Item_Id),t=le?s.Igst_P:s.Gst_P;if($){const l=R(1,d,t),s=(0,_.od)(d,l);e.TotalTax+=(0,_.eX)(a,l),e.TotalValue+=(0,_.eX)(a,s)}if(Z){const l=R(0,d,t);e.TotalTax+=(0,_.eX)(a,l),e.TotalValue+=(0,_.eX)(a,d)}return e}),{TotalValue:0,TotalTax:0});return(0,a.useEffect)((()=>{q((e=>null===e||void 0===e?void 0:e.map((e=>({...e,Amount:(0,_.eX)(null===e||void 0===e?void 0:e.Item_Rate,null===e||void 0===e?void 0:e.Bill_Qty)})))))}),[M.GST_Inclusive]),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{className:"p-3 pt-0",children:[(0,B.jsxs)("div",{className:"p-3 bg-light rounded-3 mb-3 shadow-sm",children:[(0,B.jsx)("h5",{className:"border-bottom",children:"From:"}),(0,B.jsxs)("div",{className:"row",children:[(0,B.jsx)("div",{className:"col-lg-8 col-md-7",children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsx)("tr",{children:(0,B.jsx)("td",{className:"border-0 bg-light",colSpan:2,children:null===U||void 0===U?void 0:U.Company_Name})}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Address:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:null===U||void 0===U?void 0:U.Company_Address})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Phone:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:null===U||void 0===U?void 0:U.Telephone_Number})]})]})})}),(0,B.jsx)("div",{className:"col-lg-4 col-md-5",children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Date:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:(0,B.jsx)("input",{type:"date",value:null!==M&&void 0!==M&&M.So_Date?(0,_.Q7)(null===M||void 0===M?void 0:M.So_Date):"",onChange:e=>L({...M,So_Date:e.target.value}),className:"cus-inpt p-1"})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Invoice Type:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:(0,B.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>L({...M,GST_Inclusive:Number(e.target.value)}),value:M.GST_Inclusive,children:[(0,B.jsx)("option",{value:1,children:"Inclusive Tax"}),(0,B.jsx)("option",{value:0,children:"Exclusive Tax"}),(0,B.jsx)("option",{value:2,children:"Not Taxable"})]})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Tax Type:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:(0,B.jsxs)("select",{className:"cus-inpt p-1",onChange:e=>L({...M,IS_IGST:Number(e.target.value)}),value:M.IS_IGST,children:[(0,B.jsx)("option",{value:"0",children:"GST"}),(0,B.jsx)("option",{value:"1",children:"IGST"})]})})]})]})})})]})]}),(0,B.jsxs)("div",{className:"p-3 bg-light rounded-3 mb-3 shadow-sm",children:[(0,B.jsx)("h5",{className:"border-bottom",children:"To:"}),(0,B.jsxs)("div",{className:"row ",children:[(0,B.jsx)("div",{className:"col-md-6",children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Retailer Name:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:(0,B.jsx)(m.cp,{value:{value:null===M||void 0===M?void 0:M.Retailer_Id,label:null===M||void 0===M?void 0:M.Retailer_Name},onChange:e=>L({...M,Retailer_Id:e.value,Retailer_Name:e.label}),options:[{value:"",label:"select",isDisabled:!0},...b.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:h.cF,isSearchable:!0,placeholder:"Retailer Name",maxMenuHeight:200})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Address:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:x.Name})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Phone:"}),(0,B.jsx)("td",{className:"border-0 bg-light"})]})]})})}),(0,B.jsx)("div",{className:"col-md-6",children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Q-Pay:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:10})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border-0 bg-light",children:"Frequency Days:"}),(0,B.jsx)("td",{className:"border-0 bg-light",children:20})]})]})})})]})]}),(0,B.jsx)("div",{className:"d-flex align-items-end justify-content-end flex-wrap mb-3",children:(0,B.jsx)(r.c,{onClick:()=>K(!0),sx:{ml:1},variant:"outlined",startIcon:(0,B.jsx)(p.c,{}),children:"Add Product"})}),(0,B.jsx)(S.c,{dataArray:E,columns:[{isCustomCell:!0,Cell:e=>{var l;let{row:d}=e;return null===d||void 0===d||null===(l=d.Product)||void 0===l?void 0:l.Product_Name},ColumnHeader:"Product",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:d}=e;return null===d||void 0===d||null===(l=d.Product)||void 0===l?void 0:l.HSN_Code},ColumnHeader:"HSN Code",isVisible:1},{isCustomCell:!0,Cell:e=>{var l;let{row:d}=e;return(null===d||void 0===d?void 0:d.Bill_Qty)+" "+(null!==(l=null===d||void 0===d?void 0:d.Units)&&void 0!==l?l:"")},ColumnHeader:"Quantity",isVisible:1,align:"center"},{Field_Name:"Item_Rate",ColumnHeader:"Rate",Fied_Data:"number",isVisible:1,align:"right"},{ColumnHeader:"Taxable Amount",isCustomCell:!0,Cell:e=>{var l,d,a,s,t;let{row:i}=e;const r=null!==(l=le?null===i||void 0===i||null===(d=i.Product)||void 0===d?void 0:d.Igst_P:(0,_.Q5)(null===i||void 0===i||null===(a=i.Product)||void 0===a?void 0:a.Cgst_P,null===i||void 0===i||null===(s=i.Product)||void 0===s?void 0:s.Sgst_P))&&void 0!==l?l:0,o=null!==(t=i.Amount)&&void 0!==t?t:0,n=R(M.GST_Inclusive,o,r);return(0,_.SA)($?o-n:o)},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{var l,d,a,s,t;let{row:i}=e;const r=null!==(l=le?null===i||void 0===i||null===(d=i.Product)||void 0===d?void 0:d.Igst_P:(0,_.Q5)(null===i||void 0===i||null===(a=i.Product)||void 0===a?void 0:a.Cgst_P,null===i||void 0===i||null===(s=i.Product)||void 0===s?void 0:s.Sgst_P))&&void 0!==l?l:0,o=null!==(t=i.Amount)&&void 0!==t?t:0;return(0,_.SA)(R(M.GST_Inclusive,o,r))+" ("+r+"%)"},ColumnHeader:"Tax",isVisible:1,align:"right"},{ColumnHeader:"Amount",isCustomCell:!0,Cell:e=>{var l,d,a,s,t;let{row:i}=e;const r=null!==(l=le?null===i||void 0===i||null===(d=i.Product)||void 0===d?void 0:d.Igst_P:(0,_.Q5)(null===i||void 0===i||null===(a=i.Product)||void 0===a?void 0:a.Cgst_P,null===i||void 0===i||null===(s=i.Product)||void 0===s?void 0:s.Sgst_P))&&void 0!==l?l:0,o=null!==(t=i.Amount)&&void 0!==t?t:0,n=R(M.GST_Inclusive,o,r);return(0,_.SA)((0,_.Qr)(M.GST_Inclusive,1)?o:o+n)},isVisible:1,align:"right"},{isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(t.c,{onClick:()=>{var e,d,a,s,t;z({Item_Id:l.Item_Id,ItemName:null===l||void 0===l||null===(e=l.Product)||void 0===e?void 0:e.Product_Name,Bill_Qty:l.Bill_Qty,Item_Rate:l.Item_Rate,UOM:l.Product.UOM_Id,Product:l.Product,Group:null===l||void 0===l||null===(d=l.Product)||void 0===d?void 0:d.Pro_Group,GroupID:null===l||void 0===l||null===(a=l.Product)||void 0===a?void 0:a.Product_Group,Brand:null===l||void 0===l||null===(s=l.Product)||void 0===s?void 0:s.Brand_Name,BrandID:null===l||void 0===l||null===(t=l.Product)||void 0===t?void 0:t.Brand,Amount:null===l||void 0===l?void 0:l.Amount}),K(!0)},size:"small",children:(0,B.jsx)(j.c,{})}),(0,B.jsx)(t.c,{size:"small",onClick:()=>{q((e=>e.filter((e=>!(0,_.Qr)(e.Item_Id,l.Item_Id)))))},color:"error",children:(0,B.jsx)(y.c,{})})]})},ColumnHeader:"Action",isVisible:1}],EnableSerialNumber:!0,CellSize:"small",disablePagination:!0}),E.length>0&&(0,B.jsx)("div",{className:"d-flex justify-content-end py-2",children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsxs)("tr",{children:[(0,B.jsxs)("td",{className:"border p-2",rowSpan:(0,_.Qr)(M.IS_IGST,1)?4:5,children:["Total in words: ",(0,_.m4)(parseInt(ae))]}),(0,B.jsx)("td",{className:"border p-2",children:"Total Taxable Amount"}),(0,B.jsx)("td",{className:"border p-2",children:(0,_.SA)(se.TotalValue)})]}),(0,_.Qr)(M.IS_IGST,1)?(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2",children:"IGST"}),(0,B.jsx)("td",{className:"border p-2",children:(0,_.SA)(se.TotalTax)})]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2",children:"CGST"}),(0,B.jsx)("td",{className:"border p-2",children:(0,_.SA)(se.TotalTax/2)})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2",children:"SGST"}),(0,B.jsx)("td",{className:"border p-2",children:(0,_.SA)(se.TotalTax/2)})]})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2",children:"Round Off"}),(0,B.jsx)("td",{className:"border p-2",children:(0,_.SA)(ae-(se.TotalValue+se.TotalTax))})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2",children:"Total"}),(0,B.jsx)("td",{className:"border p-2",children:(0,_.SA)(ae)})]})]})})}),(0,B.jsx)("p",{className:"fa-15 mt-3 m-0",children:"Narration"}),(0,B.jsx)("textarea",{className:"cus-inpt ",value:M.Narration,onChange:e=>L((l=>({...l,Narration:e.target.value})))}),(0,B.jsxs)("div",{className:"d-flex justify-content-end",children:[(0,B.jsx)(r.c,{variant:"outlined",startIcon:(0,B.jsx)(P.c,{}),onClick:o,children:"cancel"}),(0,B.jsx)(r.c,{onClick:()=>{if((null===E||void 0===E?void 0:E.length)>0&&null!==M&&void 0!==M&&M.Retailer_Id)d(),(0,N.q)({address:"sales/saleOrder",method:W?"PUT":"POST",bodyData:{...M,Product_Array:E.filter((e=>(0,_.QT)(null===e||void 0===e?void 0:e.Bill_Qty,0)))}}).then((e=>{e.success?(C.m4.success(null===e||void 0===e?void 0:e.message),i(),L(H),q([])):C.m4.error(null===e||void 0===e?void 0:e.message)})).catch((e=>console.error(e))).finally((()=>s()));else{if(E.length<=0)return C.m4.error("Enter any one product quantity");if(null===M||void 0===M||!M.Retailer_Id)return C.m4.error("Select Retailer")}},sx:{ml:1},variant:"outlined",color:"success",startIcon:(0,B.jsx)(T.c,{}),disabled:0===(null===E||void 0===E?void 0:E.length)||!(null!==M&&void 0!==M&&M.Retailer_Id),children:"Save"})]})]}),(0,B.jsxs)(n.c,{open:Y,onClose:de,maxWidth:"sm",fullWidth:!0,children:[(0,B.jsx)(c.c,{className:"border-bottom",children:(0,B.jsx)("span",{children:"Add Products Details"})}),(0,B.jsxs)("form",{onSubmit:e=>{e.preventDefault(),X.Item_Id&&X.Bill_Qty&&X.Item_Rate?(((e,l,d,a,s,t)=>{const i=E.findIndex((l=>(0,_.Qr)(l.Item_Id,e)));if(-1!==i){const e=[...E];e[i].Bill_Qty=Number(l),e[i].Item_Rate=Number(d),e[i].UOM=s,e[i].Units=t,e[i].Amount=(0,_.eX)(l,d),e[i]={...e[i],Product:a},q(e)}else q((i=>[...i,{Item_Id:e,Bill_Qty:Number(l),Item_Rate:Number(d),UOM:s,Units:t,Amount:(0,_.eX)(l,d),Product:a}]))})(X.Item_Id,X.Bill_Qty,X.Item_Rate,X.Product,X.UOM,X.Units),de()):C.m4.warn(X.Item_Id?X.Bill_Qty?"Enter Rate or Amount":"Enter Quantity":"Select Product")},children:[(0,B.jsx)(u.c,{children:(0,B.jsxs)("div",{className:"row pb-5",children:[(0,B.jsxs)("div",{className:"col-6 p-2",children:[(0,B.jsx)("label",{children:"Brand"}),(0,B.jsx)(m.cp,{value:{value:X.BrandID,label:X.Brand},onChange:e=>z((l=>({...l,BrandID:e.value,Brand:e.label}))),options:[{value:"",label:"select",isDisabled:!0},...D.map((e=>({value:null===e||void 0===e?void 0:e.Brand,label:null===e||void 0===e?void 0:e.Brand_Name})))],styles:h.cF,isSearchable:!0,placeholder:"Select Brand",maxMenuHeight:200})]}),(0,B.jsxs)("div",{className:"col-6 p-2",children:[(0,B.jsx)("label",{children:"Group"}),(0,B.jsx)(m.cp,{value:{value:X.GroupID,label:X.Group},onChange:e=>z((l=>({...l,GroupID:e.value,Group:e.label}))),options:[{value:"",label:"select",isDisabled:!0},...g.filter((e=>!X.BrandID||(0,_.Qr)(e.Brand,X.BrandID))).reduce(((e,l)=>(e.some((e=>e.value===l.Product_Group))||e.push({value:l.Product_Group,label:l.Pro_Group}),e)),[])],styles:h.cF,isSearchable:!0,placeholder:"Select Group",maxMenuHeight:200})]}),(0,B.jsxs)("div",{className:"col-12 p-2",children:[(0,B.jsxs)("label",{children:["Item Name ",(0,B.jsx)(G.c,{})]}),(0,B.jsx)(m.cp,{value:{value:X.Item_Id,label:X.ItemName},onChange:e=>{const l=g.find((l=>(0,_.Qr)(l.Product_Id,e.value)));z((d=>{var a,s,t,i,r,o,n;return{...d,Item_Id:e.value,ItemName:e.label,Product:null!==l&&void 0!==l?l:{},Group:null!==(a=l.Pro_Group)&&void 0!==a?a:d.Group,GroupID:null!==(s=l.Product_Group)&&void 0!==s?s:d.GroupID,Brand:null!==(t=l.Brand_Name)&&void 0!==t?t:d.Brand,BrandID:null!==(i=l.Brand)&&void 0!==i?i:d.BrandID,UOM:null!==(r=l.UOM_Id)&&void 0!==r?r:d.UOM,Units:null!==(o=l.Units)&&void 0!==o?o:d.Units,Item_Rate:null!==(n=l.Item_Rate)&&void 0!==n?n:0,Amount:0,Bill_Qty:0}}))},options:[{value:"",label:"select",isDisabled:!0},...[...g.filter((e=>!X.BrandID||(0,_.Qr)(e.Brand,X.BrandID))).filter((e=>!X.GroupID||(0,_.Qr)(e.Product_Group,X.GroupID)))].map((e=>({value:null===e||void 0===e?void 0:e.Product_Id,label:null===e||void 0===e?void 0:e.Product_Name,isDisabled:-1!==E.findIndex((l=>(0,_.Qr)(null===l||void 0===l?void 0:l.Item_Id,null===e||void 0===e?void 0:e.Product_Id)))})))],styles:h.cF,isSearchable:!0,required:!0,placeholder:"Select Product",maxMenuHeight:200})]}),(0,B.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,B.jsxs)("label",{children:["Quantity ",(0,B.jsx)(G.c,{})]}),(0,B.jsx)("input",{type:"number",required:!0,value:X.Bill_Qty?X.Bill_Qty:"",onChange:e=>{X.Item_Rate?z((l=>({...l,Amount:(0,_.eX)(X.Item_Rate,e.target.value),Bill_Qty:e.target.value}))):X.Amount?z((l=>({...l,Item_Rate:(0,_.yy)(l.Amount,e.target.value),Bill_Qty:e.target.value}))):z((l=>({...l,Bill_Qty:e.target.value})))},className:"cus-inpt",min:1})]}),(0,B.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,B.jsx)("label",{children:"Rate "}),(0,B.jsx)("input",{type:"number",value:X.Item_Rate?(0,_.SA)(X.Item_Rate):"",onChange:e=>z((l=>({...l,Item_Rate:e.target.value,Amount:l.Bill_Qty?(0,_.eX)(e.target.value,l.Bill_Qty):l.Amount}))),min:1,className:"cus-inpt"})]}),(0,B.jsxs)("div",{className:"col-lg-4 col-md-6 p-2",children:[(0,B.jsx)("label",{children:"UOM"}),(0,B.jsxs)("select",{value:X.UOM,onChange:e=>{const l=e.target.selectedIndex,d=e.target.options[l].text,a=e.target.value;z((e=>({...e,UOM:a,Units:d})))},className:"cus-inpt",children:[(0,B.jsx)("option",{value:"",disabled:!0,children:"select"}),w.map(((e,l)=>(0,B.jsx)("option",{value:e.Unit_Id,children:e.Units},l)))]})]}),(0,B.jsxs)("div",{className:"col-md-6 p-2",children:[(0,B.jsx)("label",{children:"Amount"}),(0,B.jsx)("input",{type:"number",value:X.Amount?X.Amount:"",onChange:e=>z((l=>({...l,Amount:e.target.value,Item_Rate:l.Bill_Qty?(0,_.yy)(e.target.value,l.Bill_Qty):l.Item_Rate}))),className:"cus-inpt",min:1})]})]})}),(0,B.jsxs)(v.c,{className:"d-flex justify-content-between align-items-center",children:[(0,B.jsx)(r.c,{onClick:()=>z(k),type:"button",startIcon:(0,B.jsx)(f.c,{}),children:"Clear"}),(0,B.jsxs)("span",{children:[(0,B.jsx)(r.c,{type:"button",onClick:de,children:"cancel"}),(0,B.jsx)(r.c,{type:"submit",variant:"outlined",children:"Add"})]})]})]})]})]})},D=e=>{let{loadingOn:l,loadingOff:d}=e;const C=JSON.parse(localStorage.getItem("user")),[y,P]=(0,a.useState)([]),[T,f]=(0,a.useState)([]),[G,R]=(0,a.useState)([]),[A,D]=(0,a.useState)([]),[F,w]=(0,a.useState)(!0),[O,U]=(0,a.useState)({}),[V,H]=(0,a.useState)({}),[k,M]=(0,a.useState)(!1),[L,E]=(0,a.useState)({Fromdate:(0,_.SO)(7),Todate:(0,_.Q7)(),Retailer_Id:"",RetailerGet:"ALL",Created_by:"",CreatedByGet:"ALL",Sales_Person_Id:"",SalsePersonGet:"ALL",Cancel_status:0}),[q,X]=(0,a.useState)({filters:!1,orderDetails:!1});(0,a.useEffect)((()=>{(0,N.q)({address:"sales/saleOrder?Fromdate=".concat(null===L||void 0===L?void 0:L.Fromdate,"&Todate=").concat(null===L||void 0===L?void 0:L.Todate,"&Retailer_Id=").concat(null===L||void 0===L?void 0:L.Retailer_Id,"&Sales_Person_Id=").concat(null===L||void 0===L?void 0:L.Sales_Person_Id,"&Created_by=").concat(null===L||void 0===L?void 0:L.Created_by,"&Cancel_status=").concat(null===L||void 0===L?void 0:L.Cancel_status)}).then((e=>{e.success&&P(null===e||void 0===e?void 0:e.data)})).catch((e=>console.error(e)))}),[L.Fromdate,null===L||void 0===L?void 0:L.Todate,null===L||void 0===L?void 0:L.Retailer_Id,null===L||void 0===L?void 0:L.Sales_Person_Id,null===L||void 0===L?void 0:L.Created_by,null===L||void 0===L?void 0:L.Cancel_status,k]),(0,a.useEffect)((()=>{(0,N.q)({address:"masters/retailers/dropDown?Company_Id=".concat(null===C||void 0===C?void 0:C.Company_id)}).then((e=>{e.success&&f(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:"masters/users/salesPerson/dropDown?Company_id=".concat(null===C||void 0===C?void 0:C.Company_id)}).then((e=>{e.success&&R(e.data)})).catch((e=>console.error(e))),(0,N.q)({address:"masters/user/dropDown?Company_id=".concat(null===C||void 0===C?void 0:C.Company_id)}).then((e=>{e.success&&D(e.data)})).catch((e=>console.error(e)))}),[]);const z=[{Field_Name:"So_Id",ColumnHeader:"Order ID",Fied_Data:"string",isVisible:1},{Field_Name:"Retailer_Name",ColumnHeader:"Customer",Fied_Data:"string",isVisible:1},{Field_Name:"So_Date",ColumnHeader:"Date",Fied_Data:"date",isVisible:1,align:"center"},{Field_Name:"Total_Before_Tax",ColumnHeader:"Before Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Tax",ColumnHeader:"Tax",Fied_Data:"number",isVisible:1,align:"center"},{Field_Name:"Total_Invoice_value",ColumnHeader:"Invoice Value",Fied_Data:"number",isVisible:1,align:"center"},{ColumnHeader:"Status",isVisible:1,align:"center",isCustomCell:!0,Cell:e=>{var l,d;let{row:a}=e;const s=g.o.find((e=>e.id===Number(null===a||void 0===a?void 0:a.isConverted)));return(0,B.jsx)("span",{className:null!==(l="py-0 fw-bold px-2 rounded-4 fa-12 "+(null===s||void 0===s?void 0:s.color))&&void 0!==l?l:"bg-secondary text-white",children:null!==(d=null===s||void 0===s?void 0:s.label)&&void 0!==d?d:"Undefined"})}},{Field_Name:"Action",isVisible:1,isCustomCell:!0,Cell:e=>{let{row:l}=e;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(s.c,{title:"View Order",children:(0,B.jsx)(t.c,{onClick:()=>{H({orderDetails:l,orderProducts:null!==l&&void 0!==l&&l.Products_List?null===l||void 0===l?void 0:l.Products_List:[]})},color:"primary",size:"small",children:(0,B.jsx)(b.c,{className:"fa-16"})})}),(0,B.jsx)(s.c,{title:"Edit",children:(0,B.jsx)(t.c,{onClick:()=>{W(),console.log(l),U({...l,isEdit:!0})},size:"small",children:(0,B.jsx)(j.c,{className:"fa-16"})})})]})}}],W=()=>{w(!F),U({})},J=()=>{X({...q,filters:!1,orderDetails:!1}),U({})};return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(i.c,{children:[(0,B.jsxs)("div",{className:"p-3 py-2 d-flex align-items-center justify-content-between",children:[(0,B.jsx)("h6",{className:"fa-18 m-0 p-0",children:F?"Sale Orders":(0,_.CY)(O)?"Modify Sale Order":"Sale Order Creation"}),(0,B.jsxs)("span",{children:[F&&(0,B.jsx)(s.c,{title:"Filters",children:(0,B.jsx)(t.c,{size:"small",onClick:()=>X({...q,filters:!0}),children:(0,B.jsx)(I.c,{})})}),F&&(0,B.jsx)(r.c,{variant:"outlined",startIcon:(0,B.jsx)(p.c,{}),onClick:W,children:"New"})]})]}),(0,B.jsx)(o.c,{className:"p-0 ",children:F?(0,B.jsx)(S.c,{dataArray:y,columns:z,isExpendable:!0,tableMaxHeight:550,expandableComp:e=>{let{row:l}=e;return(0,B.jsx)(B.Fragment,{children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Branch"}),(0,B.jsx)("td",{className:"border p-2",children:l.Branch_Name}),(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,B.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name}),(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Round off"}),(0,B.jsx)("td",{className:"border p-2",children:l.Round_off})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Invoice Type"}),(0,B.jsxs)("td",{className:"border p-2",children:[(0,_.Qr)(l.GST_Inclusive,1)&&"Inclusive",(0,_.Qr)(l.GST_Inclusive,0)&&"Exclusive"]}),(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Tax Type"}),(0,B.jsxs)("td",{className:"border p-2",children:[(0,_.Qr)(l.IS_IGST,1)&&"IGST",(0,_.Qr)(l.IS_IGST,0)&&"GST"]}),(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Sales Person"}),(0,B.jsx)("td",{className:"border p-2",children:l.Sales_Person_Name})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{className:"border p-2 bg-light",children:"Narration"}),(0,B.jsx)("td",{className:"border p-2",colSpan:5,children:l.Narration})]})]})})})}}):(0,B.jsx)(Q,{editValues:O,loadingOn:l,loadingOff:d,reload:()=>{M((e=>!e)),w((e=>!e))},switchScreen:W})})]}),Object.keys(V).length>0&&(0,B.jsx)(x.c,{orderDetails:null===V||void 0===V?void 0:V.orderDetails,orderProducts:null===V||void 0===V?void 0:V.orderProducts,download:!0,actionOpen:!0,clearDetails:()=>H({}),TitleText:"Sale Order"}),(0,B.jsxs)(n.c,{open:q.filters,onClose:J,fullWidth:!0,maxWidth:"sm",children:[(0,B.jsx)(c.c,{children:"Filters"}),(0,B.jsx)(u.c,{children:(0,B.jsx)("div",{className:"table-responsive pb-4",children:(0,B.jsx)("table",{className:"table",children:(0,B.jsxs)("tbody",{children:[(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{style:{verticalAlign:"middle"},children:"Retailer"}),(0,B.jsx)("td",{children:(0,B.jsx)(m.cp,{value:{value:null===L||void 0===L?void 0:L.Retailer_Id,label:null===L||void 0===L?void 0:L.RetailerGet},onChange:e=>E({...L,Retailer_Id:e.value,RetailerGet:e.label}),options:[{value:"",label:"ALL"},...T.map((e=>({value:null===e||void 0===e?void 0:e.Retailer_Id,label:null===e||void 0===e?void 0:e.Retailer_Name})))],styles:h.cF,isSearchable:!0,placeholder:"Retailer Name"})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{style:{verticalAlign:"middle"},children:"Salse Person"}),(0,B.jsx)("td",{children:(0,B.jsx)(m.cp,{value:{value:null===L||void 0===L?void 0:L.Sales_Person_Id,label:null===L||void 0===L?void 0:L.SalsePersonGet},onChange:e=>E({...L,Sales_Person_Id:e.value,SalsePersonGet:e.label}),options:[{value:"",label:"ALL"},...G.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:h.cF,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{style:{verticalAlign:"middle"},children:"Created By"}),(0,B.jsx)("td",{children:(0,B.jsx)(m.cp,{value:{value:null===L||void 0===L?void 0:L.Created_by,label:null===L||void 0===L?void 0:L.CreatedByGet},onChange:e=>E({...L,Created_by:e.value,CreatedByGet:e.label}),options:[{value:"",label:"ALL"},...A.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name})))],styles:h.cF,isSearchable:!0,placeholder:"Sales Person Name"})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{style:{verticalAlign:"middle"},children:"From"}),(0,B.jsx)("td",{children:(0,B.jsx)("input",{type:"date",value:L.Fromdate,onChange:e=>E({...L,Fromdate:e.target.value}),className:"cus-inpt"})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{style:{verticalAlign:"middle"},children:"To"}),(0,B.jsx)("td",{children:(0,B.jsx)("input",{type:"date",value:L.Todate,onChange:e=>E({...L,Todate:e.target.value}),className:"cus-inpt"})})]}),(0,B.jsxs)("tr",{children:[(0,B.jsx)("td",{style:{verticalAlign:"middle"},children:"Canceled Order"}),(0,B.jsx)("td",{children:(0,B.jsxs)("select",{type:"date",value:L.Cancel_status,onChange:e=>E({...L,Cancel_status:Number(e.target.value)}),className:"cus-inpt",children:[(0,B.jsx)("option",{value:1,children:"Show"}),(0,B.jsx)("option",{value:0,children:"Hide"})]})})]})]})})})}),(0,B.jsx)(v.c,{children:(0,B.jsx)(r.c,{onClick:J,children:"close"})})]})]})}}}]);
//# sourceMappingURL=616.12303cc9.chunk.js.map