"use strict";(self.webpackChunkerp=self.webpackChunkerp||[]).push([[2744],{64568:(e,a,s)=>{s.d(a,{c:()=>r});var t=s(82496);const r=()=>(0,t.jsx)("span",{style:{color:"red",fontWeight:"bold",fontSize:"1em"},children:" *"})},62344:(e,a,s)=>{s.d(a,{o$:()=>n,o5:()=>l,cF:()=>c,iI:()=>r});const t=s.p+"static/media/smt.aa4d4f940bbebff07a57.png",r={table:{style:{width:"auto",backgroundColor:"transparent"}},rows:{style:{backgroundColor:"transparent"}},headCells:{style:{backgroundColor:"#6b9080f8",color:"white",fontSize:"14px"}}},c={control:(e,a)=>({...e,height:"45px",background:"rgba(255, 255, 255, 0.322)"}),menu:(e,a)=>({...e,zIndex:9999})},n=[{id:1,headname:"Menu ID",variant:"head",align:"left",width:100},{id:2,headname:"MenuName"},{id:3,headname:"Read Rights"},{id:4,headname:"Add Rights"},{id:5,headname:"Edit Rights"},{id:6,headname:"Delete Rights"},{id:7,headname:"Print Rights"},{id:8,headname:"Action"}],l=[{dataBase:1,name:"SHANKAR TRADERS",business:"Wholesale Merchant in Dhall",address:"32, Chitrakara Street, Madurai - 01 <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:t,gstin:"33AADFS6973R1ZD",phone:"984-313-1353, 984-335-5166",fssai:"12418012000818",bankAccount:"0021 5032 0885 122",ifsc:"TMBL0000002"},{dataBase:2,name:"SMT AGRO PRODUCTS",business:"",address:"H.O: 153, Chitrakara Street, 2nd Floor, Madurai -01 <br /> G.O: 746 Puliyur, Sayanapuram, Svga <br /> Bill of Supply -Disclaimer Affidavlt Field Extemped",logo:t,gstin:"33ACMFS3420Q1ZQ",phone:"0452-4371625",fssai:"12418012000818",bankAccount:"0025 3031 0875 947",ifsc:"TMBL0000002"},{dataBase:3,name:"BHAVANI TRADERS",business:"",address:"H.O: 152-A, Chitrakara Street, Madurai -01 <br /> G.O: 30/1-Rajman Nagar, Chintamani Main Road, Mdu-01 <br /> Tax Invoice",logo:t,gstin:"33AAEFB6728J1ZG",phone:"958-559-7641, 958-559-7614",fssai:"12418012000670",bankAccount:"0021 5005 0800 309",ifsc:"TMBL0000002"}]},25576:(e,a,s)=>{s.r(a),s.d(a,{default:()=>ce});var t=s(69060),r=s(5548),c=s(82656),n=s(26773),l=s(4488),d=s(90048),o=s(28655),i=s(14168),m=s(86e3),h=s(57704),p=s(56480),u=s(77536),x=s(1908),_=(s(21680),s(64568)),y=s(39308),j=s(82496);const g=e=>{let{open:a,onClose:s,inputValue:r,isEdit:o,setReload:i}=e;const m=localStorage.getItem("user"),h=JSON.parse(m),[u,g]=(0,t.useState)([]),[T,v]=(0,t.useState)([]),[b,S]=(0,t.useState)({Project_Id:"",Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,y.Q7)(),Est_End_Dt:(0,y.Q7)(),Project_Status:"",Entry_By:null===h||void 0===h?void 0:h.UserId,Company_id:null===h||void 0===h?void 0:h.Company_id});(0,t.useEffect)((()=>{(0,x.q)({address:"masters/users/employee/dropDown?Company_id=".concat(null===h||void 0===h?void 0:h.Company_id)}).then((e=>{g(e.success?e.data:[])})).catch((e=>console.error("Fetch Error:",e)))}),[null===h||void 0===h?void 0:h.Company_id]),(0,t.useEffect)((()=>{(0,x.q)({address:"taskManagement/statusList"}).then((e=>{e.success&&v(e.data)})).catch((e=>console.error("Fetch Error:",e)))}),[]),(0,t.useEffect)((()=>{a&&(o&&r?S({...r,Project_Head:null===r||void 0===r?void 0:r.Project_Head_Id,Est_Start_Dt:r.Est_Start_Dt?(0,y.Q7)(r.Est_Start_Dt):"",Est_End_Dt:r.Est_End_Dt?(0,y.Q7)(r.Est_End_Dt):"",Project_Status:(null===r||void 0===r?void 0:r.Project_Status)||"",Project_Desc:(null===r||void 0===r?void 0:r.Project_Desc)||"-"}):o||S({Project_Name:"",Project_Desc:"",Project_Head:"",Est_Start_Dt:(0,y.Q7)(),Est_End_Dt:(0,y.Q7)(),Project_Status:"",Entry_By:null===h||void 0===h?void 0:h.UserId,Company_id:null===h||void 0===h?void 0:h.Company_id}))}),[r,a,o]);const k=e=>{S({...b,[e.target.name]:e.target.value})},f=()=>{const e=["Project_Name","Project_Head","Est_Start_Dt","Est_End_Dt","Project_Status"];for(const a of e)if(!b[a])return p.m4.error("".concat(a.replace(/_/g," ")," is required")),!1;return!0},I=[{label:"Project Name",elem:"input",type:"text",required:!0,name:"Project_Name",value:b.Project_Name||""},{label:"Project Head",elem:"select",options:u.map((e=>({value:null===e||void 0===e?void 0:e.UserId,label:null===e||void 0===e?void 0:e.Name}))),required:!0,name:"Project_Head",value:b.Project_Head||""},{label:"Estimated Start Date",elem:"input",type:"date",required:!0,name:"Est_Start_Dt",value:b.Est_Start_Dt||""},{label:"Estimated End Date",elem:"input",type:"date",required:!0,name:"Est_End_Dt",value:b.Est_End_Dt||""},{label:"Project Status",elem:"select",options:T.map((e=>({value:e.Status_Id,label:e.Status}))),required:!0,name:"Project_Status",value:b.Project_Status||""},{label:"Description",elem:"textarea",name:"Project_Desc",value:b.Project_Desc||" "}];return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(c.c,{open:a,onClose:s,children:[(0,j.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:o?"Edit Project":"Create Project"}),(0,j.jsx)(l.c,{children:(0,j.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o?f()&&(0,x.q)({address:"taskManagement/project",method:"PUT",bodyData:b}).then((e=>{e.success?(s(),i((e=>!e)),p.m4.success(e.message)):p.m4.error(e.message)})).catch((e=>console.error("Fetch Error:",e))):(()=>{if(!f())return;const e={...b,Company_id:h.Company_id};(0,x.q)({address:"taskManagement/project",method:"POST",bodyData:e}).then((e=>{e.success?(s(),i((e=>!e)),p.m4.success(e.message)):p.m4.error(e.message)})).catch((e=>{console.error("Fetch Error:",e),p.m4.error("An error occurred while creating the project.")}))})()},children:[(0,j.jsx)("div",{className:"row",children:I.map(((e,a)=>(0,j.jsxs)("div",{className:"col-lg-4 mb-3",children:[(0,j.jsxs)("label",{children:[e.label," ",e.required&&(0,j.jsx)(_.c,{})]}),"textarea"===e.elem?(0,j.jsx)("textarea",{name:e.name,className:"cus-inpt",value:e.value,onChange:k}):"select"===e.elem?(0,j.jsxs)("select",{name:e.name,className:"cus-inpt",value:e.value,onChange:k,children:[(0,j.jsx)("option",{value:"",children:"Select"}),e.options&&e.options.map(((e,a)=>(0,j.jsx)("option",{value:e.value,children:e.label},a)))]}):(0,j.jsx)("input",{type:e.type,name:e.name,className:"cus-inpt",value:e.value,onChange:k})]},a)))}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:s,children:"Cancel"}),(0,j.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:o?"Update":"Submit"})]})]})})]})})};var T=s(89e3),v=s(99904),b=s(33856),S=s(58612),k=s(27454),f=s(700),I=s(29504),N=s(71448),E=s(44380),C=s(12572),D=s(76552);const P=e=>{let{open:a,onClose:s,projectId:r,onReload:o}=e;const i={Name:"",Designation_Name:"",BranchName:""},[m,h]=(0,t.useState)(i),[_,y]=(0,t.useState)(!0),[g,P]=(0,t.useState)(!1),[w,A]=(0,t.useState)([]),[R,q]=(0,t.useState)([]),O=localStorage.getItem("user"),B=JSON.parse(O),{contextObj:F}=(0,t.useContext)(u.a);(0,t.useEffect)((()=>{a&&r&&(M(),L(),U())}),[a,r]);const M=async()=>{y(!0);try{const e=await(0,x.q)({address:"masters/Employeedetails?Project_Id=".concat(r)});e.success&&h(e.data)}catch(e){console.error(e),p.m4.error("Failed to fetch employee details")}finally{y(!1)}},L=async()=>{y(!0);try{const e=await(0,x.q)({address:"masters/Employeedetails/dropDown?Company_id=".concat(B.Company_id)});e.success&&A(e.data)}catch(e){console.error(e),p.m4.error("Failed to fetch employees for dropdown")}finally{y(!1)}},U=async()=>{y(!0);try{const e=await(0,x.q)({address:"masters/Employeedetails?Project_Id=".concat(r)});e.success&&q(e.data)}catch(e){console.error(e),p.m4.error("Failed to fetch assigned employees")}finally{y(!1)}},W=()=>{s(),h(i)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(c.c,{open:a,maxWidth:"sm",fullWidth:!0,children:[(0,j.jsxs)(C.c,{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:2,marginInlineStart:2,children:[(0,j.jsx)("span",{children:"Employee Details"}),(0,j.jsx)(d.c,{children:(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:()=>{P(!0)},sx:{mr:1},children:"Add"})})]}),(0,j.jsx)(l.c,{children:_?(0,j.jsx)("p",{children:"Loading..."}):(0,j.jsx)(v.c,{children:(0,j.jsxs)(b.c,{children:[(0,j.jsx)(S.c,{children:(0,j.jsxs)(k.c,{children:[(0,j.jsx)(f.c,{children:"Employee Name"}),(0,j.jsx)(f.c,{children:"Position"}),(0,j.jsx)(f.c,{children:"Department"})]})}),(0,j.jsx)(I.c,{children:Array.isArray(m)&&m.length>0?m.map((e=>(0,j.jsxs)(k.c,{children:[(0,j.jsx)(f.c,{children:e.Name||"N/A"}),(0,j.jsx)(f.c,{children:e.Designation_Name||"-"}),(0,j.jsx)(f.c,{children:e.BranchName||"-"})]},e.EmployeeId||e.UserId))):(0,j.jsx)(k.c,{children:(0,j.jsx)(f.c,{colSpan:3,children:"No data available"})})})]})})}),(0,j.jsx)(d.c,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:W,children:"Close"})})]}),(0,j.jsxs)(c.c,{open:g,maxWidth:"sm",fullWidth:!0,children:[(0,j.jsx)(n.c,{children:"Add Employee"}),(0,j.jsx)(l.c,{children:(0,j.jsx)(N.c,{multiple:!0,options:w,getOptionLabel:e=>e.Name,isOptionEqualToValue:(e,a)=>e.UserId===a.UserId,onChange:(e,a)=>{const s=a.filter(((e,a,s)=>a===s.findIndex((a=>a.UserId===e.UserId))));q(s)},PopperComponent:e=>(0,j.jsx)(D.c,{...e,placement:"top"}),value:R,onClose:onclose,renderInput:e=>(0,j.jsx)(E.c,{...e,placeholder:"Employees"})})}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)(T.c,{onClick:()=>{P(!1),W(),h(i)},children:"Cancel"}),(0,j.jsx)(T.c,{onClick:async()=>{if(1===Number(null===F||void 0===F?void 0:F.Add_Rights))try{(await(0,x.q)({address:"masters/Employeedetails/employeeAdd",method:"POST",bodyData:{Project_Id:r,UserIds:R.map((e=>e.UserId))}})).success?(p.m4.success("Employees added successfully"),P(!1),await M(),await U(),o()):p.m4.error("Failed to add employees")}catch(e){console.error(e),p.m4.error("Error adding employees")}},variant:"contained",color:"primary",children:"Add"})]})]})]})};var w=s(32635),A=s(15786),R=s(56880),q=s(6392),O=s(21280),B=s(70564),F=s(27532),M=s(98204),L=s(35880),U=(s(67472),s(68424)),W=s(39504),G=s(52924);const H=(0,j.jsx)(U.c,{fontSize:"small"}),z=(0,j.jsx)(W.c,{fontSize:"small"}),J=e=>{let{row:a,children:s,openAction:r,reload:o,onCloseFun:i,loadingOn:m,loadingOff:h,onTaskAdded:u}=e;const g=localStorage.getItem("user"),T=JSON.parse(g),v={Task_Id:"",Task_Name:"",Task_Desc:"",Task_Group_Id:"",Entry_By:null===T||void 0===T?void 0:T.UserId,Company_id:null===T||void 0===T?void 0:T.Company_id,Entry_Date:"",Update_By:"",Update_Date:"",Task_Parameters:[]},[b,S]=(0,t.useState)(!1),[k,f]=(0,t.useState)(!1),[I,C]=(0,t.useState)([]),[D,P]=(0,t.useState)([]),[w,A]=(0,t.useState)([]),[R,q]=(0,t.useState)(v),[O,B]=(0,t.useState)(!1),[F,M]=(0,t.useState)(v);(0,t.useEffect)((()=>{(async()=>{try{const e=await(0,x.q)({address:"taskManagement/tasks/dropdown"});e.success&&C(e.data);const a=await(0,x.q)({address:"masters/taskType/dropDown"});a.success&&P(a.data);const s=await(0,x.q)({address:"taskManagement/parameters"});s.success&&A(s.data)}catch(e){console.error(e)}})()}),[]),(0,t.useEffect)((()=>{S(r)}),[r]),(0,t.useEffect)((()=>{(0,y.CY)(a)?(console.log(a),q((e=>({...e,...a,Task_Group_Id:a.Task_Group_Id||""}))),f(!0)):(q(v),f(!1))}),[a]);const L=()=>{S(!1),i&&i()},U=()=>{B(!1),M(v)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{onClick:()=>S(!0),style:{cursor:"pointer"},children:s}),(0,j.jsxs)(c.c,{open:b,children:[(0,j.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:k?"Edit Task":"Add Task"}),(0,j.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=R.Task_Parameters.map((e=>({...e,Param_Id:e.Paramet_Id})))||[],a={...R,Task_Parameters:e};m&&m();try{const e=await(0,x.q)({address:"taskManagement/tasks",method:k?"PUT":"POST",bodyData:a});e.success?(p.m4.success(e.message),q(v),L(),o&&o(),u&&u()):p.m4.error(e.message)}catch(s){console.error(s),p.m4.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,j.jsx)(l.c,{children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsxs)("div",{className:"col-md-4 p-2",children:[(0,j.jsxs)("label",{children:["Task Name ",(0,j.jsx)(_.c,{})]}),(0,j.jsx)("input",{maxLength:150,onChange:e=>q({...R,Task_Name:e.target.value}),required:!0,value:R.Task_Name,placeholder:"ex: File Checking",className:"cus-inpt"})]}),(0,j.jsxs)("div",{className:"col-md-4 p-2",children:[(0,j.jsxs)("label",{children:["Task Group ",(0,j.jsx)(_.c,{})]}),(0,j.jsxs)("select",{value:R.Task_Group_Id,className:"cus-inpt",required:!0,onChange:e=>q({...R,Task_Group_Id:e.target.value}),children:[(0,j.jsx)("option",{value:"",disabled:!0,children:"- select -"}),D.map(((e,a)=>(0,j.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},a)))]})]}),(0,j.jsxs)("div",{className:"col-md-4 p-2",children:[(0,j.jsx)("label",{children:"Base Task"}),(0,j.jsxs)("select",{value:R.Under_Task_Id,className:"cus-inpt",onChange:e=>q({...R,Under_Task_Id:e.target.value}),children:[(0,j.jsx)("option",{value:0,children:"Primary"}),I.map(((e,a)=>(0,j.jsx)("option",{value:e.Task_Id,children:e.Task_Name},a)))]})]}),(0,j.jsxs)("div",{className:"col-12",children:[(0,j.jsxs)("label",{children:["Task Description ",(0,j.jsx)(_.c,{})]}),(0,j.jsx)("textarea",{className:"cus-inpt",value:R.Task_Desc,rows:"3",onChange:e=>q({...R,Task_Desc:e.target.value})})]}),(0,j.jsx)("div",{className:"col-md-12 p-2",children:(0,j.jsx)(N.c,{multiple:!0,id:"checkboxes-tags-demo",options:w,disableCloseOnSelect:!0,getOptionLabel:e=>"".concat(e.Paramet_Name," - ").concat(e.Paramet_Data_Type),value:R.Task_Parameters||[],onChange:(e,a)=>q({...R,Task_Parameters:a}),renderOption:(e,a,s)=>{let{selected:t}=s;return(0,j.jsxs)("li",{...e,children:[(0,j.jsx)(G.c,{icon:H,checkedIcon:z,style:{marginRight:8},checked:t}),"".concat(a.Paramet_Name," - ").concat(a.Paramet_Data_Type)]})},className:"pt-2",isOptionEqualToValue:(e,a)=>Number(e.Paramet_Id)===Number(a.Paramet_Id),renderInput:e=>(0,j.jsx)(E.c,{...e,label:"Task Parameters",placeholder:"Choose Task Parameters"})})}),R.Task_Parameters.map(((e,a)=>(0,j.jsxs)("div",{className:"col-md-4 p-2",children:[(0,j.jsx)("label",{className:"mb-2",children:e.Paramet_Name}),(0,j.jsx)("input",{type:e.Paramet_Data_Type||"text",className:"cus-inpt",onChange:e=>{const s=[...R.Task_Parameters];s[a]={...s[a],Default_Value:e.target.value},q({...R,Task_Parameters:s})},value:e.Default_Value,placeholder:"Default Value"})]},a)))]})}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:L,children:"Cancel"}),(0,j.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Submit"})]})]})]}),(0,j.jsxs)(c.c,{open:O,onClose:U,children:[(0,j.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Edit Task"}),(0,j.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{const e=F.Task_Parameters.map((e=>({...e,Param_Id:e.Paramet_Id})))||[],a={...F,Task_Parameters:e};m&&m();try{const e=await(0,x.q)({address:"taskManagement/tasks",method:"PUT",bodyData:a});e.success?(p.m4.success(e.message),U(),o&&o(),u&&u()):p.m4.error(e.message)}catch(s){console.error(s),p.m4.error("An error occurred while processing your request.")}finally{h&&h()}})()},children:[(0,j.jsxs)(l.c,{children:[(0,j.jsx)(E.c,{label:"Task Name",value:F.Task_Name,onChange:e=>M({...F,Task_Name:e.target.value}),fullWidth:!0}),(0,j.jsxs)(E.c,{label:"Task Group",select:!0,value:F.Task_Group_Id,onChange:e=>M({...F,Task_Group_Id:e.target.value}),fullWidth:!0,children:[(0,j.jsx)("option",{value:"",disabled:!0,children:"- select -"}),D.map(((e,a)=>(0,j.jsx)("option",{value:e.Task_Type_Id,children:e.Task_Type},a)))]})]}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)("button",{className:"btn btn-light rounded-5 px-3",type:"button",onClick:U,children:"Cancel"}),(0,j.jsx)("button",{className:"btn btn-primary rounded-5 px-3",type:"submit",children:"Save"})]})]})]})]})};var Q=s(55888),V=s(30612),Y=s(62344);const Z=e=>{let{open:a,onClose:s,projectId:r,taskId:o,reload:i,editData:m}=e;const h=localStorage.getItem("user"),u=JSON.parse(h),[_,y]=(0,t.useState)([]),[g,v]=(0,t.useState)(!1),[b,S]=(0,t.useState)([]),k={AN_No:"",Project_Id:r,Sch_Id:o,Assigned_Emp_Id:null===u||void 0===u?void 0:u.UserId,Emp_Id:"",Task_Assign_dt:(new Date).toISOString().split("T")[0],Sch_Period:"",Sch_Time:"",EN_Time:"",Est_Start_Dt:"",Est_End_Dt:"",Ord_By:1,Timer_Based:!1,Sch_Type:"",Invovled_Stat:!0,EmpGet:"- Select -",Is_Repitative:!1,RepeatDays:{Mon:!1,Tue:!1,Wed:!1,Thu:!1,Fri:!1,Sat:!1,Sun:!1}},[f,I]=(0,t.useState)(k);(0,t.useEffect)((()=>{a&&(async()=>{v(!0);try{const e=await(0,x.q)({address:"masters/Employeedetails/getusersproject?Project_Id=".concat(r)}),a=await(0,x.q)({address:"taskManagement/project/schedule/newscheduleType"});e.success&&y(e.data||[]),a.success}catch(e){p.m4.error("Failed to fetch data.")}finally{v(!1)}})()}),[r,a,i]),(0,t.useEffect)((()=>{a&&(async()=>{v(!0);try{if(m){var e,a;const s=await(0,x.q)({address:"masters/employeedetails/selectedTaskDetails?projectId=".concat(r,"&Sch_Id=").concat(o.Sch_Id,"&Task_Id=").concat(o.Task_Id)}),t=null===(e=s.data[0])||void 0===e?void 0:e.Sch_Type_Id,c=null===(a=s.data[0])||void 0===a?void 0:a.Sch_Name;S(t&&c?{value:t,label:c}:{value:"",label:""})}else{var s,t;const e=await(0,x.q)({address:"masters/employeedetails/selectedTaskDetails?projectId=".concat(r,"&Sch_Id=").concat(o.TaskSchId,"&Task_Id=").concat(o.Task_Id)}),a=null===(s=e.data[0])||void 0===s?void 0:s.Sch_Type_Id,c=null===(t=e.data[0])||void 0===t?void 0:t.Sch_Name;S(a&&c?{value:a,label:c}:{value:"",label:""})}}catch(c){p.m4.error("Failed to fetch data.")}finally{v(!1)}})()}),[a,m,i,r]),(0,t.useEffect)((()=>{m&&I((e=>({...e,AN_No:m.AN_No,Emp_Id:m.Emp_Id,Sch_Time:m.Sch_Time,EN_Time:m.EN_Time,Est_Start_Dt:m.Est_Start_Dt.split("T")[0],Est_End_Dt:m.Est_End_Dt.split("T")[0],Ord_By:m.Ord_By,Timer_Based:m.Timer_Based,Invovled_Stat:m.Invovled_Stat,Sch_Type_Id:m.Sch_Type,Sch_Type:m.Sch_Type_Name,EmpGet:m.EmployeeName,Is_Repitative:m.Is_Repitative,RepeatDays:{Mon:!!m.IS_Rep_Monday,Tue:!!m.IS_Rep_Tuesday,Wed:!!m.IS_Rep_Wednesday,Thu:!!m.IS_Rep_Thursday,Fri:!!m.Is_Rep_Friday,Sat:!!m.Is_Rep_Saturday,Sun:!!m.Is_Rep_Sunday}})))}),[m]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(c.c,{open:a,maxWidth:"sm",children:[(0,j.jsx)(n.c,{children:m?"Edit Task":"Employee Assign"}),(0,j.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const a=(()=>{const[e,a]=f.Sch_Time.split(":").map(Number),[s,t]=f.EN_Time.split(":").map(Number),r=new Date(0,0,0,e,a),c=new Date(0,0,0,s,t);if(c>r){let e=Math.abs(c-r);const a=Math.floor(e/36e5),s=Math.floor(e/6e4);return"".concat(String(a).padStart(2,"0"),":").concat(String(s).padStart(2,"0"))}return""})();if(f.Est_End_Dt<f.Est_Start_Dt)p.m4.error("End date must be greater than start date.");else try{const e=m?"masters/employeedetails/updateTask":"masters/employeedetails/assignTask",t={IS_Rep_Monday:f.RepeatDays.Mon?1:null,IS_Rep_Tuesday:f.RepeatDays.Tue?1:null,IS_Rep_Wednesday:f.RepeatDays.Wed?1:null,IS_Rep_Thursday:f.RepeatDays.Thu?1:null,Is_Rep_Friday:f.RepeatDays.Fri?1:null,Is_Rep_Saturday:f.RepeatDays.Sat?1:null,Is_Rep_Sunday:f.RepeatDays.Sun?1:null};(await(0,x.q)({address:e,method:m?"PUT":"POST",bodyData:{...f,Project_Id:r,Sch_Id:m?o.Sch_Id:o.TaskSchId,Task_Levl_Id:o.Task_Levl_Id,Task_Id:Number(o.Task_Id),Assigned_Emp_Id:f.Assigned_Emp_Id,Emp_Id:f.Emp_Id,Sch_Period:a,Sch_Time:f.Sch_Time,EN_Time:f.EN_Time,Est_Start_Dt:f.Est_Start_Dt,Est_End_Dt:f.Est_End_Dt,Ord_By:f.Ord_By,Sch_Type:b.value,Timer_Based:f.Timer_Based?1:0,Invovled_Stat:f.Invovled_Stat?1:0,Is_Repitative:f.Is_Repitative?1:0,RepeatDays:f.Is_Repitative?f.RepeatDays:"",...t}})).success?(p.m4.success("Task ".concat(m?"updated":"assigned"," successfully!")),I({}),s()):p.m4.error("Please fill the values correctly")}catch(t){p.m4.error("Error during task assignment/update: "+t.message)}},children:[(0,j.jsxs)(l.c,{className:"table-responsive",children:[g&&(0,j.jsx)("div",{children:"Loading..."}),(0,j.jsx)("table",{className:"table",style:{tableLayout:"fixed"},children:(0,j.jsxs)("tbody",{children:[(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Employee"}),(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,j.jsx)(V.cp,{value:{value:f.Emp_Id,label:f.EmpGet},onChange:e=>I({...f,Emp_Id:e.value,EmpGet:e.label}),options:[{value:"",label:"- Select -"},..._.map((e=>({value:e.UserId,label:e.Name})))],styles:Y.cF,required:!0,isSearchable:!0,placeholder:"Select User"})})]}),(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Sch_Type"}),(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,j.jsx)(V.cp,{value:b?{value:b.value,label:"".concat(b.label)}:null,styles:{padding:"0.5em"},isDisabled:!0,placeholder:"Select Sch_Type"})})]}),(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Start Time"}),(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,j.jsx)("input",{type:"time",className:"cus-inpt",value:f.Sch_Time,required:!0,onChange:e=>I({...f,Sch_Time:e.target.value}),style:{padding:"0.5em"}})})]}),(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"End Time"}),(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,j.jsx)("input",{type:"time",className:"cus-inpt",value:f.EN_Time,required:!0,min:f.Sch_Time,onChange:e=>I({...f,EN_Time:e.target.value}),style:{padding:"0.5em"}})})]}),(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. Start Date"}),(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,j.jsx)("input",{type:"date",className:"cus-inpt",value:f.Est_Start_Dt,required:!0,onChange:e=>I({...f,Est_Start_Dt:e.target.value}),style:{padding:"0.5em"}})})]}),(0,j.jsxs)("tr",{children:[(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{verticalAlign:"middle",paddingRight:"1em"},children:"Est. End Date"}),(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingLeft:"1em"},children:(0,j.jsx)("input",{type:"date",className:"cus-inpt",value:f.Est_End_Dt,required:!0,min:f.Est_Start_Dt,onChange:e=>I({...f,Est_End_Dt:e.target.value}),style:{padding:"0.5em"}})})]}),(0,j.jsx)("tr",{children:(0,j.jsxs)("td",{className:"border-bottom-0 fa-15 text-start",style:{paddingRight:"1em"},children:[(0,j.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,j.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",id:"timerbased",checked:Boolean(Number(null===f||void 0===f?void 0:f.Timer_Based)),onChange:e=>I({...f,Timer_Based:e.target.checked}),style:{marginRight:"0.5em"}}),(0,j.jsx)("label",{className:"form-check-label p-1 ps-2",htmlFor:"timerbased",children:"Timer Based Task?"})]}),m&&(0,j.jsxs)("div",{style:{display:"inline-flex",marginRight:"1em"},children:[(0,j.jsx)("input",{className:"form-check-input shadow-none",type:"checkbox",checked:Boolean(Number(null===f||void 0===f?void 0:f.Invovled_Stat)),onChange:()=>I({...f,Invovled_Stat:!f.Invovled_Stat}),style:{marginRight:"0.5em"}}),(0,j.jsx)("label",{className:"form-check-label p-1 ps-2",children:"Involved Status"})]})]})}),(0,j.jsx)("tr",{children:(0,j.jsx)("td",{className:"border-bottom-0 fa-15",style:{paddingRight:"1em"},children:(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"1em"},children:[(0,j.jsx)("input",{type:"checkbox",checked:1===f.Is_Repitative,onChange:e=>{I((a=>({...a,Is_Repitative:e.target.checked?1:0})))},style:{marginRight:"1em"}}),(0,j.jsx)("label",{style:{marginBottom:"0"},children:"Is Repetitive?"})]}),1===f.Is_Repitative&&(0,j.jsx)("div",{style:{display:"inline-flex",gap:"0.5em"},children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((e=>(0,j.jsxs)("label",{style:{display:"flex",alignItems:"center",marginRight:"1em",width:"30px"},children:[(0,j.jsx)("input",{type:"checkbox",checked:f.RepeatDays[e],onChange:()=>I({...f,RepeatDays:{...f.RepeatDays,[e]:!f.RepeatDays[e]}}),style:{marginRight:"0.5em"}}),e]},e)))})]})})})]})})]}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)(T.c,{onClick:()=>{s(),I(k)},variant:"outlined",children:"Close"}),(0,j.jsx)(T.c,{type:"submit",variant:"contained",children:"Save Changes"})]})]})]})})};var K=s(63468),$=s(63172),X=s(86848);const ee=function(e){let{open:a,onClose:s,taskDetails:d,closeDialogTask:o}=e;const[i,h]=(0,t.useState)(null),[p,x]=(0,t.useState)(!1),[_,y]=(0,t.useState)(!0),{contextObj:g}=(0,t.useContext)(u.a);(0,t.useEffect)((()=>{a&&(h(null),y(!0),setTimeout((()=>{y(!1)}),500))}),[a]);const N=e=>{if(!e)return"N/A";const a=new Date(e);if(isNaN(a.getTime()))return"Invalid Date";const s=String(a.getDate()).padStart(2,"0"),t=String(a.getMonth()+1).padStart(2,"0"),r=a.getFullYear();return"".concat(s,"-").concat(t,"-").concat(r)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(c.c,{open:a,maxWidth:"lg",children:[(0,j.jsx)(n.c,{children:(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,j.jsx)("span",{children:"Details"}),(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:s,children:"Close"})]})}),(0,j.jsx)(l.c,{children:_?(0,j.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",width:"500px"},children:(0,j.jsx)(K.c,{})}):(0,j.jsx)(v.c,{children:(0,j.jsxs)(b.c,{children:[(0,j.jsx)(S.c,{children:(0,j.jsxs)(k.c,{children:[(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Employee"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Assigned By"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Start-End Date"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Start-End Time"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Total Hours"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Timer Based"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Involved Status"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Order By"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:"Action"})]})}),(0,j.jsx)(I.c,{children:0===d.length?(0,j.jsx)(k.c,{children:(0,j.jsx)(f.c,{colSpan:9,className:"fa-14 text-center",style:{textAlign:"center"},children:"No data found"})}):d.map(((e,a)=>(0,j.jsxs)(k.c,{children:[(0,j.jsx)(f.c,{className:"fa-13 text-center",children:e.EmployeeName||"N/A"}),(0,j.jsx)(f.c,{className:"fa-13 text-center",children:e.AssignedUser||"N/A"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:(0,j.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,j.jsx)($.c,{className:"fa-18 me-2"}),N(e.Est_Start_Dt)," - ",N(e.Est_End_Dt)]})}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:(0,j.jsxs)("span",{className:"badge rounded-4 px-3 bg-light text-primary",children:[(0,j.jsx)(X.c,{className:"fa-18 me-2"}),e.Sch_Time||"N/A"," - ",e.EN_Time||"N/A"]})}),(0,j.jsx)(f.c,{className:"fa-13 text-center",children:e.Sch_Period||"N/A"}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:(0,j.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Timer_Based)?"bg-success":"bg-warning"),children:Number(e.Timer_Based)?"Yes":"No"})}),(0,j.jsx)(f.c,{className:"fa-14 text-center",children:(0,j.jsx)("span",{className:"badge rounded-4 px-3 fw-bold text-white ".concat(Number(e.Invovled_Stat)?"bg-success":"bg-danger"),children:Number(e.Invovled_Stat)?"IN":"OUT"})}),(0,j.jsx)(f.c,{className:"fa-13 text-center",children:e.Ord_By||"N/A"}),1===Number(null===g||void 0===g?void 0:g.Edit_Rights)&&(0,j.jsx)(f.c,{className:"fa-13 text-center",children:(0,j.jsxs)(r.c,{size:"small",onClick:()=>(h(e),void x(!0)),children:[(0,j.jsx)(m.c,{className:"fa-18"}),"Edit"]})})]},a)))})]})})})]}),p&&(0,j.jsx)(Z,{open:p,projectId:null===i||void 0===i?void 0:i.Project_Id,taskId:i,editData:i,onClose:()=>{x(!1),s()}})]})};var ae=s(18256),se=s(29720),te=s(61584);const re=function(e){let{dialogOpen:a,setDialogOpen:s,projectid:o,reload:i,onReload:h,selectedProject:_}=e;const[y,g]=(0,t.useState)(!1),[I,N]=(0,t.useState)(!1),[E,D]=(0,t.useState)(!1),[P,w]=(0,t.useState)(null),[U,W]=(0,t.useState)([]),[G,H]=(0,t.useState)([]),[z,V]=(0,t.useState)(!1),[Y,K]=(0,t.useState)({Sch_Type_Id:"",Sch_Type:""}),[$,X]=(0,t.useState)([]),[re,ce]=(0,t.useState)(!1),ne=JSON.parse(localStorage.getItem("user")),le=null===ne||void 0===ne?void 0:ne.UserId,de=null===ne||void 0===ne?void 0:ne.Company_id,[oe,ie]=(0,t.useState)(!1),[me,he]=(0,t.useState)(null),[pe,ue]=(0,t.useState)(null),{contextObj:xe}=(0,t.useContext)(u.a),[_e,ye]=(0,t.useState)(!1),[je,ge]=(0,t.useState)(!1),[Te,ve]=(0,t.useState)("1"),[be,Se]=(0,t.useState)([]),ke=(e,a)=>{ve(a)},fe=(0,t.useCallback)((async()=>{try{const e=await(0,x.q)({address:"taskManagement/tasks/dropdown?Company_id=".concat(de)});e.success?W(e.data):p.m4.error(e.message)}catch(e){console.error(e)}}),[de]),Ie=(0,t.useCallback)((async()=>{try{const e=await(0,x.q)({address:"taskManagement/project/schedule/ListingDetails?Project_Id=".concat(o)});e.success?X(e.data):console.error("Failed to fetch task details:",e.message)}catch(e){console.error("Error fetching task details:",e)}}),[o]);(0,t.useEffect)((()=>{fe(),Ie(),(async()=>{(0,x.q)({address:"taskManagement/project/schedule/newscheduleType"}).then((e=>{e.success?(console.log("data.data",e.data),Se(e.data)):p.m4.error(e.message)}))})()}),[i,o,h]);const Ne=U.map((e=>({value:e.Task_Id,label:e.Task_Name}))),Ee=e=>{console.log("e",e);const a=be.find((a=>a.Sch_Type_Id===parseInt(e.target.value)));a&&K({...Y,Sch_Type_Id:a.Sch_Type_Id,Sch_Type:a.Sch_Type})};return(0,j.jsxs)(j.Fragment,{children:[je&&(0,j.jsxs)(c.c,{open:je,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},onClose:()=>ge(!1),children:[(0,j.jsx)(n.c,{children:_e?"Edit Task":"Assign Task"}),(0,j.jsx)(l.c,{children:(0,j.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,j.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,j.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,j.jsxs)("select",{value:Y.Sch_Type_Id||"",onChange:Ee,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,j.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),be.map(((e,a)=>(0,j.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},a)))]})]})})}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)(T.c,{onClick:()=>ge(!1),children:"Cancel"}),(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:()=>(async e=>{const a={Sch_Project_Id:e.Sch_Project_Id,Sch_Id:e.TaskSchId,schtypeid:Y.Sch_Type_Id,Task_Id:e.Task_Id};try{const e=await(0,x.q)({address:"taskManagement/project/schedule/updateScheduleTaskUpdate",method:"PUT",bodyData:a});e.success?(p.m4.success(e.message),ge(!1),ye(!1),h()):(e.status,p.m4.warn(e.message||"Task already exists for this project."))}catch(s){p.m4.error(s)}})(Y),children:"Save"})]})]}),(0,j.jsxs)(c.c,{open:a,fullWidth:!0,maxWidth:"lg",PaperProps:{style:{height:"75vh"}},children:[(0,j.jsx)(n.c,{children:(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,j.jsx)("span",{children:null===_||void 0===_?void 0:_.Project_Name}),(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:()=>N(!0),children:"Assign Task"})]})}),(0,j.jsx)(C.c,{sx:{width:"100%",typography:"body1"},children:$.map(((e,a)=>{const s=JSON.parse(e.SchTypes);return(0,j.jsxs)(ae.cp,{value:Te,children:[(0,j.jsx)(C.c,{sx:{borderBottom:1,borderColor:"divider"},children:(0,j.jsx)(se.c,{onChange:ke,"aria-label":"Schedule Types",children:Array.isArray(s)&&s.length>0?s.map(((e,a)=>(0,j.jsx)(A.c,{label:e.SchType||"No SchType",value:(e.SchTypeId||a).toString(),id:"tab-".concat(e.SchTypeId||a),"aria-controls":"tabpanel-".concat(e.SchTypeId||a)},"".concat(e.SchTypeId||"index","-").concat(a)))):(0,j.jsxs)(R.c,{variant:"body2",color:"textSecondary",sx:{padding:2},children:["No Details Available for ",s]})})}),Array.isArray(s)&&s.map(((e,a)=>(0,j.jsxs)(te.c,{value:(e.SchTypeId||a).toString(),id:"tabpanel-".concat(e.SchTypeId||a),"aria-labelledby":"tab-".concat(e.SchTypeId||a),children:[(0,j.jsx)(C.c,{sx:{marginBottom:2,padding:2,backgroundColor:"#f9f9f9",borderRadius:"8px"},children:Array.isArray(e.TaskCountsInSchType)&&e.TaskCountsInSchType.length>0?e.TaskCountsInSchType.map(((a,s)=>(0,j.jsxs)(R.c,{variant:"body1",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,j.jsxs)(C.c,{children:["Schedule Type: ",(0,j.jsx)("strong",{children:e.SchType})]}),(0,j.jsxs)(C.c,{textAlign:"right",children:["Total Tasks: ",(0,j.jsx)("strong",{children:a.TotalTasks})," / Completed Tasks: ",(0,j.jsx)("strong",{children:a.CompletedTasks})]})]},s))):(0,j.jsx)(R.c,{variant:"body2",color:"textSecondary",children:"No tasks counted for this schedule type."})}),Array.isArray(e.TaskTypeGroups)&&e.TaskTypeGroups.length>0?e.TaskTypeGroups.map((a=>(0,j.jsxs)(q.c,{expanded:me===a.Task_Type_Id,onChange:()=>{return e=a.Task_Type_Id,void he((a=>a===e?null:e));var e},sx:{backgroundColor:"#f0f4ff",boxShadow:"black"},children:[(0,j.jsxs)(O.c,{expandIcon:(0,j.jsx)(Q.c,{}),children:[(0,j.jsx)(R.c,{fontWeight:"bold",children:a.Task_Type||"Default Task Type"}),(0,j.jsx)(C.c,{sx:{textAlign:"right",flexGrow:1},children:(0,j.jsxs)(R.c,{variant:"h6",children:[(0,j.jsx)(R.c,{fontWeight:"bold",children:"Completed Task / Total Task"}),Array.isArray(a.TaskMetrics)&&a.TaskMetrics.length>0?a.TaskMetrics.map(((e,a)=>(0,j.jsxs)(R.c,{sx:{textAlign:"right",flexGrow:1},children:[e.CompletedTasks," / ",null===e||void 0===e?void 0:e.TotalTasks]},a))):(0,j.jsx)(R.c,{variant:"body2",color:"textSecondary",children:"No task metrics available for this task type."})]})})]}),(0,j.jsx)(B.c,{children:Array.isArray(a.Tasks)&&a.Tasks.length>0?a.Tasks.map((a=>(0,j.jsxs)(q.c,{expanded:pe===a.Task_Id,onChange:()=>{return e=a.Task_Id,void ue((a=>a===e?null:e));var e},sx:{marginBottom:2},children:[(0,j.jsx)(O.c,{expandIcon:(0,j.jsx)(Q.c,{}),children:(0,j.jsx)(C.c,{sx:{textAlign:"left",flexGrow:1},children:(0,j.jsx)(R.c,{fontWeight:"bold",children:(null===a||void 0===a?void 0:a.Task_Name)||"DEFAULT TASK"})})}),(0,j.jsx)(B.c,{children:(0,j.jsx)(v.c,{style:{maxHeight:"50vh"},children:(0,j.jsxs)(b.c,{stickyHeader:!0,children:[(0,j.jsx)(S.c,{style:{backgroundColor:"#2C3E50"},children:(0,j.jsxs)(k.c,{style:{backgroundColor:"#2C3E50"},children:[(0,j.jsx)(f.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task"}),(0,j.jsx)(f.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Task Type"}),(0,j.jsx)(f.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employees"}),(0,j.jsx)(f.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Employee Assign"}),(0,j.jsx)(f.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Actions"}),(0,j.jsx)(f.c,{style:{backgroundColor:"#2C3E50",color:"white"},children:"Details"})]})}),(0,j.jsxs)(k.c,{sx:{backgroundColor:"#BBE6F6"},children:[(0,j.jsx)(f.c,{children:a.Task_Name}),(0,j.jsxs)(f.c,{children:[e.SchType,(0,j.jsx)(r.c,{onClick:()=>{return e=a,ye(!0),K(e),void ge(!0);var e},children:(0,j.jsx)(m.c,{})})]}),(0,j.jsx)(f.c,{children:Array.isArray(a.AssignedEmployees)&&a.AssignedEmployees.length>0?a.AssignedEmployees.map(((e,a)=>(0,j.jsx)(F.c,{label:e.Name,variant:"outlined",size:"small",sx:{margin:"2px",color:"green"}},a))):(0,j.jsx)("span",{children:"No Employees Assigned"})}),(0,j.jsx)(f.c,{children:(0,j.jsx)(r.c,{onClick:()=>(async e=>{w(e),D(!0)})(a),children:(0,j.jsx)(M.c,{})})}),1===Number(null===xe||void 0===xe?void 0:xe.Edit_Rights)&&(0,j.jsx)(f.c,{children:(0,j.jsx)(r.c,{onClick:()=>(w(a),void ie(!0)),children:(0,j.jsx)(m.c,{})})}),(0,j.jsx)(f.c,{children:(0,j.jsx)(r.c,{onClick:()=>(async e=>{if(V(!0),e.Task_Id&&o)try{const a=await(0,x.q)({address:"masters/employeedetails/assignedTaskDetails?Task_Id=".concat(e.Task_Id,"&ProjectId=").concat(o,"&LevelId=").concat(e.Task_Levl_Id)});a.success?H(a.data):console.error(a.message)}catch(a){console.error("Error fetching task details:",a)}else p.m4.error("Task ID and Project ID are required")})(a),children:(0,j.jsx)(L.c,{})})})]},a.Task_Id)]})})})]},a.Task_Id))):(0,j.jsx)(R.c,{variant:"body2",color:"textSecondary",children:"No tasks available for this task type."})})]},a.Task_Type_Id))):(0,j.jsx)(R.c,{variant:"body2",color:"textSecondary",children:"No task type groups found for this schedule type."})]},"".concat(e.SchTypeId||"index","-").concat(a))))]},a)}))}),(0,j.jsx)(d.c,{sx:{marginTop:"auto ",position:"sticky",bottom:0},children:(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:async()=>{s(!1),K({})},children:"Close"})})]}),(0,j.jsxs)(c.c,{open:I,fullWidth:!0,maxWidth:"sm",PaperProps:{style:{borderRadius:"8px"}},children:[(0,j.jsx)(n.c,{children:"Assign Task"}),(0,j.jsxs)(l.c,{children:[(0,j.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,j.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,j.jsx)("label",{htmlFor:"task-select",style:{marginRight:"8px"},children:"Select Task"}),(0,j.jsxs)("select",{id:"task-select",value:Y.Task_Id||"",className:"cus-inpt",required:!0,onChange:e=>(async e=>{K((a=>({...a,Task_Id:e.value,TasksGet:e.label})));try{const a=await(0,x.q)({address:"taskManagement/tasks/tasklistsid?Task_Id=".concat(e.value)});if(a.success){const e=a.data;K((a=>({...a,Task_Levl_Id:e.Task_Levl_Id,Task_Name:e.Task_Name,Task_Desc:e.Task_Desc,Task_Group_Id:e.Task_Group_Id,Sch_Type_Id:e.Sch_Type_Id,Task_Sch_Duaration:e.Task_Sch_Duaration||"",Task_Start_Time:e.Task_Start_Time||(new Date).toISOString(),Task_End_Time:e.Task_End_Time||(new Date).toISOString(),Task_Est_Start_Date:e.Task_Est_Start_Date||(new Date).toISOString(),Task_Est_End_Date:e.Task_Est_End_Date||(new Date).toISOString()})))}else p.m4.error("Failed to fetch task details")}catch(a){p.m4.error(a)}})({value:e.target.value}),style:{flex:1,marginRight:"8px"},children:[(0,j.jsx)("option",{value:"",disabled:!0,children:"- select -"}),Ne.map(((e,a)=>(0,j.jsx)("option",{value:e.value,children:e.label},a)))]}),(0,j.jsx)(r.c,{onClick:()=>g(!0),children:(0,j.jsx)(T.c,{variant:"contained",color:"primary",children:"Create New"})})]})}),(0,j.jsx)("div",{style:{padding:"1px",display:"flex"},children:(0,j.jsxs)("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[(0,j.jsx)("label",{style:{marginRight:"8px"},children:"Sch_Type"}),(0,j.jsxs)("select",{value:Y.Sch_Type_Id||"",onChange:Ee,className:"cus-inpt",required:!0,style:{marginLeft:"10px"},children:[(0,j.jsx)("option",{value:"",disabled:!0,children:"- Sch_Type -"}),be.map(((e,a)=>(0,j.jsx)("option",{value:e.Sch_Type_Id,children:e.Sch_Type},a)))]})]})})]}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)(T.c,{onClick:()=>N(!1),children:"Cancel"}),(0,j.jsx)(T.c,{variant:"contained",color:"primary",onClick:async()=>{if(!Y.Task_Id||!Y.Sch_Type_Id)return void p.m4.error("Please select a task and schedule type before saving.");const e={entryBy:le,Project_Id:o,Sch_Type_Id:Y.Sch_Type_Id,Sch_Est_Start_Date:Y.Task_Est_Start_Date,Sch_Est_End_Date:Y.Task_Est_End_Date,tasks:[Y]};try{const a=await(0,x.q)({address:"taskManagement/project/schedule/createNewTaskWithSchedule",method:"POST",bodyData:e});a.success?(p.m4.success(a.message),N(!1),K({}),Ie(),h()):(a.status,p.m4.warn(a.message||"Task already exists for this project."))}catch(a){p.m4.error(a)}},children:"Save"})]})]}),(0,j.jsx)(Z,{open:E,onClose:()=>D(!1),task:P,projectId:o,entryBy:le,taskId:P,reload:i,onReload:h}),(0,j.jsxs)(c.c,{open:re,onClose:()=>ce(!1),children:[(0,j.jsx)(n.c,{children:"Delete Task"}),(0,j.jsx)(d.c,{children:(0,j.jsx)(T.c,{onClick:()=>ce(!1),color:"primary",children:"Cancel"})})]}),(0,j.jsx)(J,{openAction:y,onCloseFun:()=>g(!1),onTaskAdded:fe,Reload:i}),(0,j.jsx)(J,{row:P,openAction:oe,onCloseFun:()=>ie(!1),reload:Ie,Reload:i}),(0,j.jsx)(ee,{open:z,onClose:()=>V(!1),taskDetails:G})]})},ce=()=>{const[e,a]=(0,t.useState)(!1),[s,_]=(0,t.useState)([]),[y,T]=(0,t.useState)([]),{contextObj:v}=(0,t.useContext)(u.a),[b,S]=(0,t.useState)(!1),[k,f]=(0,t.useState)(null),[I,N]=(0,t.useState)(!1),[E,C]=(0,t.useState)(0),[D,A]=(0,t.useState)(!1),[R,q]=(0,t.useState)(null),[O,B]=(0,t.useState)(!1),[F,M]=(0,t.useState)(!1),[L,U]=(0,t.useState)(""),[W,G]=(0,t.useState)(!1),H=JSON.parse(localStorage.getItem("user"));(0,t.useEffect)((()=>{J(),Q()}),[null===H||void 0===H?void 0:H.Company_id,e]);const z=()=>{a((e=>!e)),G((e=>!e))},J=async()=>{try{const e=await(0,x.q)({address:"taskManagement/project/newProjectAbstract?Company_id=".concat(null===H||void 0===H?void 0:H.Company_id)});_(e.success?e.data:[])}catch(e){console.error(e),_([])}},Q=async()=>{try{const e=await(0,x.q)({address:"taskManagement/project?Company_id=".concat(null===H||void 0===H?void 0:H.Company_id)});T(e.success?e.data:[])}catch(e){console.error(e),T([])}},V=()=>{R&&(0,x.q)({address:"taskManagement/project",method:"DELETE",bodyData:{Project_Id:null===R||void 0===R?void 0:R.Project_Id}}).then((s=>{s.success?(a(!e),p.m4.success(s.message)):p.m4.error(s.message)})).catch((e=>console.error("Fetch Error:",e))),A(!1)},Y=[{name:"Project",selector:e=>e.Project_Name,sortable:!0,width:"250px"},{name:"Head",selector:e=>{var a;return null===(a=y.find((a=>a.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Project_Head_Name},sortable:!0},{name:"Status",selector:e=>{var a;return null===(a=y.find((a=>a.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Status},sortable:!0},{name:"End Date",selector:e=>e.Est_End_Dt?new Date(e.Est_End_Dt).toLocaleDateString("en-IN"):"N/A",sortable:!0},{name:"Progress",selector:e=>{return"".concat((a=e.TodayTaskcounts,s=e.CompletedTasks,0===Number(a)?0:(Number(s)/Number(a)*100).toFixed(0)),"%");var a,s},sortable:!0},{name:"Task Details",cell:e=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.c,{onClick:()=>$(e),children:(0,j.jsx)(o.c,{})}),e.CompletedTasks," / ",e.TodayTaskcounts]})},{name:"Task Count",selector:e=>null===e||void 0===e?void 0:e.TodayTaskcounts,sortable:!0,sortable:!0},{name:"Assigned",selector:e=>e.TasksAssignedToEmployee},{name:"Employees",cell:e=>(0,j.jsxs)(j.Fragment,{children:[1===Number(null===v||void 0===v?void 0:v.Add_Rights)&&(0,j.jsx)(r.c,{onClick:()=>ee(e.Project_Id),children:(0,j.jsx)(i.c,{})}),e.EmployeesInvolved]})},{name:"Actions",cell:e=>(0,j.jsx)(j.Fragment,{children:1===Number(null===v||void 0===v?void 0:v.Edit_Rights)&&(0,j.jsx)(r.c,{onClick:()=>K(e),children:(0,j.jsx)(m.c,{})})})}],Z=s.filter((e=>{var a,s;const t=(null===(a=y.find((a=>a.Project_Id===e.Project_Id)))||void 0===a?void 0:a.Project_Head_Name)||"",r=(null===(s=y.find((a=>a.Project_Id===e.Project_Id)))||void 0===s?void 0:s.Status)||"";return e.Project_Name.toLowerCase().includes(L.toLowerCase())||t.toLowerCase().includes(L.toLowerCase())||r.toLowerCase().includes(L.toLowerCase())})),K=e=>{f(e),N(!0),S(!0)},$=e=>{f(e),C(e.Project_Id),M(!0)},X=()=>{S(!1),M(!1),f(null),q(null),A(!1)},ee=e=>{C(e),B(!0)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"fw-bold d-flex align-items-center justify-content-between mt-0 ",children:[(0,j.jsx)("span",{style:{marginLeft:"20px"},children:"Projects"}),(0,j.jsxs)("div",{className:"mb-1",style:{display:"flex",alignItems:"center"},children:[(0,j.jsxs)("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[(0,j.jsx)(h.c,{style:{position:"absolute",left:15,color:"#aaa"}}),(0,j.jsx)("input",{type:"text",placeholder:"Search",onChange:e=>U(e.target.value),style:{paddingLeft:35,marginRight:10,margin:10,borderRadius:4,border:"1px solid black"}})]}),1===Number(null===v||void 0===v?void 0:v.Add_Rights)&&(0,j.jsx)("button",{onClick:()=>{f(null),N(!1),S(!0)},className:"btn btn-primary fa-13 shadow",children:"Create Project"})]})]}),(0,j.jsxs)("div",{className:"card-body p-0 table-container",children:[(0,j.jsx)(w.cp,{columns:Y,data:Z,pagination:!0,highlightOnHover:!0,fixedHeader:!0,paginationPerPage:15,responsive:!0,persistTableHead:!0,customStyles:{headCells:{style:{fontSize:"16px",fontWeight:"bold",padding:"10px",backgroundColor:"#2c3e50",color:"#ecf0f1",position:"sticky",top:0,zIndex:2}},cells:{style:{padding:"8px",fontSize:"14px",backgroundColor:"#f9f9f9",color:"#2c3e50"}},rows:{style:{borderBottom:"1px solid #ddd"}}},style:{overflowY:"auto",maxHeight:"calc(100vh - 200px)"}}),(0,j.jsxs)(c.c,{open:D,onClose:X,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,j.jsx)(n.c,{className:"bg-danger text-white mb-2 px-3 py-2",style:{fontSize:"18px"},children:"Confirm Deletion"}),(0,j.jsxs)(l.c,{className:"p-4",style:{fontSize:"16px"},children:["Are you sure you want to delete the project",(0,j.jsx)("span",{className:"text-primary",children:" "+(null===R||void 0===R?void 0:R.Project_Name)+" "}),"?"]}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)("button",{onClick:()=>A(!1),className:"btn btn-secondary fa-13 shadow",style:{background:"#95a5a6",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Cancel"}),(0,j.jsx)("button",{onClick:V,className:"btn btn-danger fa-13 shadow",style:{background:"#e74c3c",color:"white",borderRadius:"25px",padding:"8px 15px",cursor:"pointer"},children:"Delete"})]})]})]}),(0,j.jsx)(re,{onClose:X,dialogOpen:F,setDialogOpen:M,isEdit:!1,parseData:H,projectid:E,onReload:z,selectedProject:k,reload:e}),(0,j.jsx)(g,{open:b,onClose:X,inputValue:k,isEdit:I,setReload:z,projectData:E}),(0,j.jsx)(P,{open:O,onClose:()=>B(!1),projectId:E,onReload:z}),(0,j.jsxs)(c.c,{open:D,onClose:X,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,j.jsx)(n.c,{className:"bg-primary text-white mb-2 px-3 py-2",children:"Confirmation"}),(0,j.jsxs)(l.c,{className:"p-4",children:["Do you want to delete the project",(0,j.jsx)("span",{className:"text-primary",children:" "+(null===R||void 0===R?void 0:R.Project_Name)+" "}),"?"]}),(0,j.jsxs)(d.c,{children:[(0,j.jsx)("button",{onClick:()=>A(!1),className:"btn btn-secondary fa-13 shadow",children:"Cancel"}),(0,j.jsx)("button",{onClick:V,className:"btn btn-danger fa-13 shadow",children:"Delete"})]})]})]})}}}]);
//# sourceMappingURL=2744.9a5291d9.chunk.js.map